{
    "link": "https://arxiv.org/abs/2407.07933",
    "pdf_link": "https://arxiv.org/pdf/2407.07933",
    "title": "Identification and Estimation of the Bi-Directional MR with Some Invalid Instruments",
    "authors": [
        "Feng Xie",
        "Zhen Yao",
        "Lin Xie",
        "Yan Zeng",
        "Zhi Geng"
    ],
    "institutions": [
        "Beijing Technology and Business University"
    ],
    "publication_date": "2024-07-10",
    "venue": "Neural Information Processing Systems",
    "fields_of_study": [
        "Computer Science",
        "Mathematics"
    ],
    "citation_count": 0,
    "influential_citation_count": 0,
    "paper_content": "# Identification and Estimation of the Bi-Directional MR with Some Invalid Instruments\n\nFeng Xie1, Zhen Yao1, Lin Xie1, Yan Zeng1,,∗Zhi Geng\n\n1Beijing Technology and Business University\n\n# Abstract\n\nWe consider the challenging problem of estimating causal effects from purely observational data in the bi-directional Mendelian randomization (MR), where some invalid instruments, as well as unmeasured confounding, usually exist. To address this problem, most existing methods attempt to find proper valid instrumental variables (IVs) for the target causal effect by expert knowledge or by assuming that the causal model is a one-directional MR model. As such, in this paper, we first theoretically investigate the identification of the bi-directional MR from observational data. In particular, we provide necessary and sufficient conditions under which valid IV sets are correctly identified such that the bi-directional MR model is identifiable, including the causal directions of a pair of phenotypes (i.e., the treatment and outcome). Moreover, based on the identification theory, we develop a cluster fusion-like method to discover valid IV sets and estimate the causal effects of interest. We theoretically demonstrate the correctness of the proposed algorithm. Experimental results show the effectiveness of our method for estimating causal effects in both one-directional and bi-directional MR models.\n\n# 1 Introduction\n\nMendelian randomization (MR) is a powerful method for estimating the causal effect of a potentially modifiable risk factor (treatment) on disease (outcome) in observational studies, which has been used across a wide variety of contexts, such as clinic [Mokry et al., 2015, Carreras-Torres et al., 2017], socioeconomics [Cuellar-Partida et al., 2016, Brumpton et al., 2020], and drug targets [Ference et al., 2015, Li et al., 2020]. Most existing MR methods assume a one-directional causal relationship. However, bi-directional relationships are ubiquitous in real-life scenarios, for example, obesity and vitamin D status [Vimaleswaran et al., 2013], body mass index (BMI) and type 2 diabetes (T2D), etc. Understanding and analyzing bi-directional relationships can provide deeper insights into complex systems, leading to more effective interventions and solutions.\n\nWithin a causal inference framework, MR can be implemented as a form of instrumental variables (IVs) analysis in which genetic variants2 serve as IVs for the modifiable risk factor. Specifically, as shown in Figure 1, suppose obesity $( X )$ and Vitamin D status $( Y )$ are the treatment and outcome of interest, respectively, and lifestyle factors (U) are the unmeasured confounders between them. One can use genetic variants $\\mathbf { G }$ as IVs to explore the causal effect of $X$ on $Y$ in observational data [Vimaleswaran et al., 2013] if $\\mathbf { G }$ are valid IVs, i.e., $\\mathbf { G }$ satisfy the following three assumptions [Wright, 1928, Goldberger, 1972, Bowden and Turkington, 1990, Hernán and Robins, 2006]:\n\nA1. [Relevance] The genetic variants $\\mathbf { G }$ are associated with the exposure $X$ ;\n\nA2. [Exclusion Restriction] The genetic variants $\\mathbf { G }$ have no direct pathway to the outcome $Y$ ;\n\nA3. [Randomness] The genetic variants $\\mathbf { G }$ are uncorrelated with unmeasured confounders U.\n\nFigure 1 illustrates these three assumptions for a genetic variant $G$ that is a valid IV relative to the causal relationship $X  Y$ . Given a valid IV $G$ in the linear model, one can estimate the causal effect of risk factor $X$ on the outcome $Y$ of interest consistently by using Two-Stage Least Squares (TSLS) [Burgess et al., 2017]. However, in most MR studies, the genetic variants may include some invalid IVs due to horizontal pleiotropy where some genetic variants may have pleiotropic effects on both the treatment $X$ and the outcome $Y$ via different biological pathways [Davey Smith and Ebrahim, 2003, Lawlor et al., 2008]. How to select valid IVs from such genetic variants becomes the major issue in the MR study. In general, valid IVs need to be chosen based on domain knowledge or expert experience [Richmond et al., 2017, Martens et al., 2006, Zhao et al., 2023]. However, it is usually difficult to select appropriate valid IVs without precise prior knowledge of genetic variants, and an invalid IV may cause biased estimation of the effect of $X$ on $Y$ [Sanderson et al., 2022, Richmond and Smith, 2022]. Therefore, it is desirable to investigate ways of selecting genetic variants as valid IVs solely from observed variables.\n\n![](images/9cf1f50679f0d944a4d07bf74c2c6c51a3fba11ddc51dfa50b3138aea0dff309.jpg)  \nFigure 1: Graphical illustration of a valid IV model, where dashed lines indicate the absence of arrows. $G$ is a valid IV relative to the causal relationship $X  Y$ .\n\nMany contributions have been made to handle MR studies with some invalid IVs under specific assumptions. Existing methods can be roughly divided into four strategies. The first strategy assumes the InSIDE assumption, which states that the genetic variants’ pleiotropic effects on the outcome $Y$ are uncorrelated with their effects on the exposure $X$ , and requires that the number of IVs increases with the sample size [Bowden et al., 2015]. The second strategy is based on the Majority rule assumption, which assumes that over $5 0 \\%$ of the candidate IVs are valid [Kang et al., 2016, Bowden et al., 2016, Windmeijer et al., 2019, Hartford et al., 2021]. The third strategy assumes the Plurality rule assumption, which means that the number of valid IVs is larger than any number of invalid IVs with the same ratio estimator limit [Guo et al., 2018, Windmeijer et al., 2021]. The last strategy assumes the Two-Valid IVs assumption, which requires that the number of valid IVs is greater than or equal to 2, and the Rank-faithfulness assumption, which states that the probability distribution $P$ is rank-faithful to a directed acyclic graph $\\mathcal { G }$ if every rank constraint on a sub-covariance matrix that holds in $P$ is entailed by every linear structural model with respect to $\\mathcal { G }$ [Silva and Shimizu, 2017, Xie et al., 2022, Cheng et al., 2023]. Although these methods have been used in various fields, they assumed that the one-directional causal relationship between $X$ and $Y$ is known and may fail to handle scenarios where bi-directional relationships are present.\n\nRecently, Darrous et al. [2021] proposed a latent heritable confounder MR method to estimate bidirectional causal effects with a hierarchical prior on the true parameters. However, their method is sensitive to prior misspecification. Later, Li and Ye [2022] introduced a focusing framework to test bi-directional causal effects under the noise distribution of the effect estimates assumption, which is exciting. However, this assumption is strictly parameterized (See Condition 1 in [Li and Ye, 2022] for more details). Moreover, they focus on the two-sample MR model that assumes homogeneity across samples, whereas we consider the one-sample MR model. See Appendix A for more details.\n\nIn this paper, we aim to investigate the identifiability of the one-sample bi-directional MR model and to provide an estimation method. Specifically, we make the following contributions:\n\n1. We present sufficient and necessary conditions for the identifiability of the bi-directional MR model, enabling both valid IV sets for each direction and the causal effects of interests to be correctly identified.   \n2. We propose a practical and effective cluster fusion-like algorithm for unbiased estimation. This algorithm correctly identifies which IVs are valid, determines the causal directions to which the valid IV sets belong, and estimates the bi-directional causal effects.   \n3. Extensive experiments demonstrate the efficacy of the proposed algorithms in MR models.\n\n# 2 Model Definition and IV Estimator\n\n# 2.1 Bi-Directional MR Causal Models\n\nSuppose we have $n$ independent samples $( X _ { i } , Y _ { i } , \\mathbf { G } _ { i } )$ from the distribution of $( X , Y , \\mathbf { G } )$ , where $X \\in \\mathbb { R }$ and $Y \\in \\mathbb { R }$ is a pair of phenotypes of interest, and $\\mathbf { G } = ( G _ { 1 } , G _ { 2 } , \\ldots , G _ { g } ) ^ { \\intercal } \\in \\mathbb { R } ^ { g }$ denotes measured genetic variants, which may include invalid IVs. Analogous to Li and Ye [2022], for each sample, indexed by $i$ , the phenotype $X _ { i }$ is taken as a linear function of the phenotype $Y _ { i }$ , genetic variants $\\mathbf { G } _ { i }$ , and an error term $\\varepsilon _ { X _ { i } }$ , while phenotype $Y _ { i }$ is modeled as a linear function of the phenotype $X _ { i }$ , genetic variants $\\mathbf { G } _ { i }$ , and an error term $\\varepsilon _ { Y _ { i } }$ . Without loss of generality, we assume that all variables have a zero mean (otherwise can be centered). Specifically, the generating process of the data is given below:\n\n$$\n\\begin{array} { r } { X = Y \\beta _ { Y  X } + \\mathbf { G } ^ { \\intercal } \\gamma _ { X } + \\varepsilon _ { X } , } \\\\ { Y = X \\beta _ { X  Y } + \\mathbf { G } ^ { \\intercal } \\gamma _ { Y } + \\varepsilon _ { Y } , } \\end{array}\n$$\n\nwhere $\\beta _ { Y  X }$ is the causal effect of $Y$ on $X$ and $\\beta _ { X  Y }$ is that of $X$ on $Y$ . $\\gamma _ { X } = ( \\gamma _ { X , 1 } , . . . , \\gamma _ { X , g } ) ^ { \\intercal }$ and $\\gamma _ { Y } = ( \\gamma _ { Y , 1 } , . . . , \\gamma _ { Y , g } ) ^ { \\intercal }$ are the direct effects of genetic variants $\\mathbf { G }$ on $X$ and $Y$ , respectively. Note that $\\varepsilon _ { X }$ and $\\varepsilon _ { Y }$ are error terms that are correlated due to unmeasured confounders $\\mathbf { U }$ between $X$ and $Y$ . Besides, there may exist a single genetic variant $G _ { i } \\in \\mathbf { G }$ with both $\\gamma _ { X , i } \\neq 0$ and $\\gamma _ { Y , i } \\neq 0$ , which implies that $G _ { i }$ also has a direct pathway to the outcome, violating Assumption A2 [Exclusion Restriction]. Like Li and Ye [2022], we here restrict the independence between any two genetic variants in $\\mathbf { G }$ (i.e., genetic variants are randomized). In Section 5, we discuss the situation where this restriction is violated. Unlike Li and Ye [2022], we allow genetic variants to cause unmeasured confounders (partially violating Assumption A3 [Randomness]).\n\nFollowing Hausman [1983], we assume that $\\beta _ { X  Y } \\beta _ { Y  X } \\neq 1 .$ Then let $\\begin{array} { r l } { \\Delta } & { { } = } \\end{array}$ $1 / ( 1 - \\beta _ { X  Y } \\beta _ { Y  X } )$ , Eq.(1) can be reorganized to avoid recursive formulations as follows:\n\n$$\n\\begin{array} { r } { X = ( \\mathbf { G } ^ { \\intercal } \\gamma _ { X } + \\mathbf { G } ^ { \\intercal } \\gamma _ { Y } \\beta _ { Y  X } + \\varepsilon _ { X } + \\varepsilon _ { Y } \\beta _ { Y  X } ) \\Delta , } \\\\ { Y = ( \\mathbf { G } ^ { \\intercal } \\gamma _ { X } \\beta _ { X  Y } + \\mathbf { G } ^ { \\intercal } \\gamma _ { Y } + \\varepsilon _ { X } \\beta _ { X  Y } + \\varepsilon _ { Y } ) \\Delta . } \\end{array}\n$$\n\nIf $\\beta _ { X  Y } \\beta _ { Y  X } = 1$ , the causal effects $\\beta _ { X  Y }$ and $\\beta _ { Y  X }$ are not identifiable, even in the presence of a valid IV.\n\nGoal. In this paper, we aim to address whether the bi-directional MR model in Eq.(1) is identifiable; that is, whether we can estimate the causal effects $\\beta _ { X  Y }$ and $\\beta _ { Y  X }$ given infinite data, even without prior knowledge about which candidate IVs are valid or invalid.\n\n# 2.2 IV Estimator\n\nIn this section, we briefly describe the classical IV estimator, the two-stage least squares (TSLS) estimator, which is capable of consistently estimating the causal effects $\\beta _ { X  Y }$ and $\\beta _ { Y  X }$ of interest in the above bi-directional MR causal model of Eq.(1) when the valid IVs are known [Wooldridge, 2010]. We denote by $\\mathbf { G } _ { \\mathcal { V } } ^ { X  Y }$ the set consisting of all valid IVs in $\\mathbf { G }$ relative to $X  Y$ , and $\\mathbf { G } _ { \\mathcal { T } } ^ { X  Y }$ the set that consists of at least one invalid IV in $\\mathbf { G }$ relative to $X  Y$ . Similar notations are applied to the inverse causal relationship $Y  X$ , i.e., $\\mathbf { G } _ { \\mathcal { V } } ^ { Y  X }$ and ${ \\bf G } _ { \\mathcal { T } } ^ { Y  X }$ .\n\nProposition 1 (Two Stage Least Square (TSLS) Estimator). Assume the system is a linear bidirectional causal model $^ { \\small 1 }$ . For a given causal relationship $X \\  \\ Y$ in the system, the causal effect of $X$ on $Y$ can be identified by\n\n$$\n{ \\hat { \\beta } } _ { X  Y } = [ X ^ { \\mathsf { \\mathsf { T } } } \\mathbf { P } X ] ^ { - 1 } X ^ { \\mathsf { \\mathsf { \\tau } } } \\mathbf { P } Y = \\beta _ { X {  } Y } ,\n$$\n\nwhere ${ \\bf P } = ( { \\bf G } _ { \\nu } ^ { X  Y } ) ^ { \\intercal } [ { \\bf G } _ { \\nu } ^ { X  Y } ( { \\bf G } _ { \\nu } ^ { X  Y } ) ^ { \\intercal } ] ^ { - 1 } { \\bf G } _ { \\nu } ^ { X  Y }$ is the projection matrix.\n\nRemark 1. Note that, when utilizing the TSLS estimator, the causal effect is biased if the candidate set $\\mathbf { G }$ includes invalid $I V s .$ . For instance, consider the causal relationship $X  Y$ , given an invalid $I V$ set $\\mathbf { G } _ { \\mathcal { T } } ^ { X  Y }$ , the causal effect of $X$ on $Y$ is given by\n\n$$\n\\begin{array} { r l } & { \\hat { \\beta } _ { X  Y } = [ X ^ { \\top } \\tilde { \\mathbf { P } } X ] ^ { - 1 } X ^ { \\top } \\tilde { \\mathbf { P } } Y } \\\\ & { = \\beta _ { X  Y } + \\underbrace { [ X ^ { \\top } \\tilde { \\mathbf { P } } X ] ^ { - 1 } X ^ { \\top } \\tilde { \\mathbf { P } } ( \\mathbf { G } ^ { \\top } \\gamma _ { Y } + \\varepsilon _ { Y } ) } _ { \\beta _ { b i a s } } , } \\\\ & { \\tilde { \\mathbf { P } } = ( \\mathbf { G } _ { \\bar { X } } ^ { X  Y } ) ^ { \\top } [ \\mathbf { G } _ { \\bar { X } } ^ { X  Y } ( \\mathbf { G } _ { \\bar { X } } ^ { X  Y } ) ^ { \\top } ] ^ { - 1 } \\mathbf { G } _ { \\bar { X } } ^ { X  Y } . } \\end{array}\n$$\n\nIn the remaining of the paper, we denote such a procedure by $\\hat { \\beta } _ { X \\to Y } ~ = ~ \\mathrm { T S L S } ( X , Y , { \\bf G } ^ { X \\to Y } )$ . Similarly, for causal relationship $Y  X$ , one can also have the corresponding causal effect of $Y$ on $X$ given the set of $\\mathrm { I V s }$ , i.e., $\\hat { \\beta } _ { Y \\to X } = \\mathrm { T S L S } ( Y , X , { \\bf G } ^ { Y \\to X } )$ . For details about the proof of Proposition 1 and Remark 1, please refer to Appendix G.1 and G.2.\n\n# 3 Identifiability of Bi-Directional MR Model\n\nIn this section, we first show by a simple example that the valid and invalid IV sets can impose different constraints. Then, we formulate these constraints and present the necessary and sufficient conditions that render the model identifiable.\n\n# 3.1 A Motivating Example\n\nFigure 2 gives an illustration of our basic idea. Suppose there are 2 valid IVs, i.e., $G _ { 1 }$ and $G _ { 3 }$ , and 3 invalid IVs, i.e., $G _ { 2 } , G _ { 4 }$ and $G _ { 5 }$ , relative to the causal relationship $X  Y$ . For the inverse $Y  X$ , identical conclusions can be derived. Assume the generating process of $X$ and $Y$ follows Eq.(1), where specifically we set all variables to have a zero mean and unit variance and $X = Y \\beta _ { Y  X } + G _ { 1 } \\gamma _ { X , 1 } + G _ { 2 } \\gamma _ { X , 2 } + G _ { 3 } \\gamma _ { X , 3 } + G _ { 4 } \\gamma _ { X , 4 } +$ $G _ { 5 } \\gamma _ { X , 5 } + \\varepsilon _ { X }$ , and $Y = X \\beta _ { X  Y } + G _ { 2 } \\gamma _ { Y , 2 } + G _ { 4 } \\gamma _ { Y , 4 } +$ $G _ { 5 } \\gamma _ { Y , 5 } + \\varepsilon _ { Y }$ , where $\\beta _ { X  Y } = \\beta _ { Y  X } = 0 . 6 , \\gamma _ { X , 1 } =$ $\\gamma _ { X , 2 } = \\gamma _ { X , 3 } = 1 , \\gamma _ { X , 4 } = 1 . 8 , \\gamma _ { X , 5 } = 1 . 2 , \\gamma _ { Y , 2 } =$ $0 . 5 , \\gamma _ { Y , 4 } = 0 . 6 , \\gamma _ { Y , 5 } = 0 . 3$ .\n\nInterestingly, we have the following observations:\n\nObservation 1. Given a valid IV set where there are at least two IVs , e.g., $\\mathbf { G } _ { \\mathcal { V } } ^ { X  Y } = ( G _ { 1 } , G _ { 3 } ) ^ { \\intercal }$ , we have:\n\n![](images/0c7a387bd1244f05dd4bafc7ad52ad60843ce7ba3542633fe66dd4030bffa78f.jpg)  \nFigure 2: An illustrative example where valid and invalid IV sets induce distinct constraints, where $\\mathbf { G } _ { \\mathcal { V } } ^ { X  Y } = ( G _ { 1 } , G _ { 3 } ) ^ { \\intercal }$ is a valid IV set, while GX→Y $( G _ { 2 } , G _ { 4 } , G _ { 5 } ) ^ { \\intercal }$ is invalid due to pathways $G _ { 2 }  Y$ , $G _ { 4 } \\to Y$ and $G _ { 5 }  Y$ .\n\n$$\n\\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 3 } \\} } , G _ { 1 } ) = 0 , \\qquad \\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 1 } \\} } , G _ { 3 } ) = 0 ,\n$$\n\nwhere $\\mathrm { c o r r } ( \\cdot )$ denotes the Pearson’s correlation coefficient between two random variables, and $\\omega _ { \\{ G _ { i } \\} } = \\mathrm { T S L S } ( X , Y , \\{ G _ { i } \\} )$ with $i \\in \\{ 1 , 3 \\}$ .\n\nObservation 2. However, given an invalid IV set, e,g., $\\mathbf { G } _ { \\mathcal { T } } ^ { X  Y } = ( G _ { 2 } , G _ { 4 } , G _ { 5 } ) ^ { \\intercal }$ , we have: $\\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 4 } , G _ { 5 } \\} } , G _ { 2 } ) \\neq 0 , \\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 2 } , G _ { 5 } \\} } , G _ { 4 } ) \\neq 0 , \\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 2 } , G _ { 4 } \\} } , G _ { 5 } ) \\neq 0 ,$ where $\\omega _ { \\{ G _ { i } , G _ { j } \\} } = \\mathrm { T S L S } ( X , Y , \\{ G _ { i } , G _ { j } \\} )$ with $i \\neq j$ and $i , j \\in \\{ 2 , 4 , 5 \\}$ .\n\nBased on these two observations, we can see that the valid and invalid IV sets entail clearly different constraints regarding the correlation coefficients3, which inspires us to further derive our identification analysis. For details about the observations, please refer to Appendix $\\mathrm { ^ c }$ .\n\n# 3.2 Main Identification Results\n\nWe begin with the following definition and the main assumptions.\n\nDefinition 1. (Pseudo-Residual) Let $\\mathbb { G }$ be a subset of candidate genetic variants. A pseudo-residual of $\\{ X , Y \\}$ relative to $\\mathbb { G }$ is defined as\n\n$$\n{ \\mathcal { P R } } _ { \\left( X , Y \\mid \\mathbb { G } \\right) } : = Y - X \\omega _ { \\mathbb { G } } ,\n$$\n\nwhere $\\omega _ { \\mathbb { G } } = { \\mathrm { T S L S } } ( X , Y , \\mathbb { G } )$ .\n\nThis “pseudo-residual\" is applied to measure the uncorrelated relationship with some genetic variants. Note that concepts to “pseudo-residual\" have been developed to address different tasks [Drton and Richardson, 2004, Chen et al., 2017, Cai et al., 2019, Xie et al., 2020], but our formalization is different from theirs in terms of the parameter $\\omega _ { \\mathbb { G } }$ . To the best of our knowledge, it has not been realized that the uncorrelated property involving such pseudo-residuals reflects the validity of the IVs in the bi-directional MR causal model (see Propositions $2 \\sim 3$ ).\n\nAs analyzed by Chu et al. [2001], within the framework of linear models, a variable being a valid IV imposes no constraints on the joint marginal distribution of the observed variables. In other words, there is no available test to determine whether a variable is a valid IV without making further assumptions. Therefore, we introduce the following assumption.\n\nAssumption 1 (Valid IV Set). For a given causal relationship (if the relationship exists), there exists $a$ valid $I V$ set that consists of at least two valid IVs. For example, for the causal relationship $X  Y$ , $| \\mathbf { G } _ { \\mathcal { V } } ^ { X  Y } | \\geq 2$ .\n\nAssumption 1 is the same as in [Silva and Shimizu, 2017, Cheng et al., 2023] if the model is a one-directional MR model. Notice that this assumption is much milder than the Majority rule assumption [Kang et al., 2016, Bowden et al., 2016, Windmeijer et al., 2019, Hartford et al., 2021] and Plurality rule assumption [Guo et al., 2018, Windmeijer et al., 2021]: Assumption 1 does not rely on the total number of genetic variants, while Majority rule and Plurality rule assumptions do.\n\nWe now show that under Assumption 1, one can identify the class of invalid IV sets.\n\nProposition 2 (Identifying Invalid IV Sets). Let $\\mathbb { G } = \\{ G _ { 1 } , \\dots , G _ { p } \\} , p \\ge 2$ be a subset of candidate genetic variants $\\mathbf { G }$ . Suppose that Assumption $^ { l }$ and the size of participants $n  \\infty$ hold. If there exists a $G _ { j } \\in \\mathbb { G }$ such that,\n\n$$\n\\operatorname { c o r r } ( { \\mathcal { P R } } _ { ( X , Y \\mid \\mathbb { G } \\backslash G _ { j } ) } , G _ { j } ) \\neq 0 ,\n$$\n\nthen $\\mathbb { G }$ is an invalid IV set for any one of the causal relationships.\n\nProposition 2 is valuable when given a set of genetic variants but lack prior knowledge of the validity of IV sets. By testing specific correlations in Eq.(5), we can conclude that the current IV set is invalid.\n\nExample 1. Consider the example in Figure 2. Suppose $\\mathbb { G } = \\{ G _ { 1 } , G _ { 2 } \\}$ , according to Proposition 2 we have $\\operatorname { c o r r } ( { \\mathcal { P R } } _ { ( X , Y \\mid \\{ G _ { 2 } \\} ) } , G _ { 1 } ) \\neq 0$ . Thus $\\mathbb { G }$ is an invalid $I V$ set.\n\nOne may naturally raise the following question: Can all the invalid IV sets be identified by Proposition 2? In other words, can we identify all the valid IV sets? Unfortunately, Assumption 1 is an insufficient condition for identifying the sets of valid IVs. See an illustrative example below.\n\nExample 2 (Counterexample). Consider the example in Figure 3. Suppose $\\mathbb { G } = \\{ G _ { 1 } , G _ { 2 } \\}$ . In subgraph (a), for $G _ { 1 } \\in \\mathbb { G }$ , according to Proposition 2 we obtain\n\n$$\n\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y \\mid \\{ G _ { 2 } \\} ) } , G _ { 1 } ) = 0\n$$\n\nSimilarly, for $G _ { 2 } \\in \\mathbb { G }$ , we have\n\n![](images/ae1dc57b86848b3ad4a530efddcad0f634e4036562a9d30c71911429174fad1e.jpg)  \nFigure 3: An illustrative example that valid and invalid IV sets may induce the same constraints in Eq.(5) of Proposition 2, where $\\{ G _ { 1 } , G _ { 2 } \\}$ is the set of valid IVs in (a), while invalid in (b). It implies Assumption 1 is not sufficient to find valid IV sets.\n\n$$\n\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y \\mid \\{ G _ { 1 } \\} ) } , G _ { 2 } ) = 0\n$$\n\nIn subgraph $( b )$ , for $G _ { 1 } \\in \\mathbb { G }$ , we check the condition of Proposition 2 and obtain\n\n$$\n\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y \\mid \\{ G _ { 2 } \\} ) } , G _ { 1 } ) = \\frac { \\gamma _ { Y , 1 } \\gamma _ { X , 2 } - \\gamma _ { Y , 2 } \\gamma _ { X , 1 } } { \\beta _ { Y  X } \\gamma _ { Y , 2 } + \\gamma _ { X , 2 } } .\n$$\n\nSimilarly, for $G _ { 2 } \\in \\mathbb { G }$ , we have\n\n$$\n\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y \\mid \\{ G _ { 1 } \\} ) } , G _ { 2 } ) = \\frac { \\gamma _ { Y , 2 } \\gamma _ { X , 1 } - \\gamma _ { Y , 1 } \\gamma _ { X , 2 } } { \\beta _ { Y  X } \\gamma _ { Y , 1 } + \\gamma _ { X , 1 } } .\n$$\n\nWe know that $\\{ G _ { 1 } , G _ { 2 } \\}$ is an invalid $I V$ set in this case. However, if the proportion of effects of $G _ { 1 }$ on $X$ and $Y$ is equal to the proportion of the effects of $G _ { 2 }$ on $X$ and $Y$ , i.e., $\\gamma _ { X , 1 } \\gamma _ { Y , 2 } = \\gamma _ { Y , 1 } \\gamma _ { X , 2 }$ , we have\n\n$$\n\\operatorname { c o r r } ( { \\mathcal { P R } } _ { ( X , Y \\mid \\{ G _ { 2 } \\} ) } , G _ { 1 } ) = 0 , \\qquad \\operatorname { c o r r } ( { \\mathcal { P R } } _ { ( X , Y \\mid \\{ G _ { 1 } \\} ) } , G _ { 2 } ) = 0 ,\n$$\n\nwhich is consistent with the conclusion of subgraph (a). These observations imply that one can not identify valid $I V$ sets under only Assumption $^ { l }$ .\n\nTo give sufficient conditions for identifying valid IV sets, we first introduce the following assumption.\n\nAssumption 2 (Generic Identifiability). For a given MR causal model, parameters $\\gamma$ and $\\beta$ live in a set of Lebesgue measure non-zero.\n\nIn other words, Assumption 2 specifically implies that given a general subset of candidate genetic variants $\\mathbb { G }$ , there exists a $G _ { j } \\in \\mathbb { G }$ that satisfies $\\begin{array} { r } { \\big | \\sum _ { G _ { i } \\in \\mathbb { G } / G _ { j } } \\hat { \\beta } _ { i } c o \\hat { v } ( G _ { i } , G _ { i } ) \\big [ ( \\gamma _ { X , i } + \\gamma _ { X , U } \\gamma _ { U , i } ) \\hat { ( } \\gamma _ { Y , j } + } \\end{array}$ $\\gamma _ { Y , U } \\gamma _ { U , j } ) - ( \\gamma _ { Y , i } + \\gamma _ { Y , U } \\gamma _ { U , i } ) ( \\gamma _ { X , j } + \\gamma _ { X , U } \\gamma _ { U , j } ) ] | \\neq 0$ , where $\\bar { \\beta } _ { i } \\neq 0$ is the estimated coefficient between $G _ { i }$ and $X$ . For instance, in Example 2, such an assumption simplifies to $\\gamma _ { X , 1 } \\gamma _ { Y , 2 } \\neq \\gamma _ { Y , 1 } \\gamma _ { X , 2 }$ . Whenever $\\gamma _ { X , 1 } \\gamma _ { Y , 2 } = \\gamma _ { Y , 1 } \\gamma _ { X , 2 }$ , parameters $\\gamma$ and $\\beta$ would fall into a set of Lebesgue measure zero, rendering non-identifiable of the model. It is worth noting that in real life, although we cannot obtain the ground truths of causal effects between variables, especially when latent confounders are involved, Assumption 2 is generally satisfied. This is because the set of conditions to violate it occupies a very small portion of the entire space.\n\nWith Assumption 2, we now derive sufficient conditions for generic identifiability in Proposition 3. Proposition 3 (Identifying Valid IV Sets). Let $\\mathbb { G } = \\{ G _ { 1 } , \\dots , G _ { p } \\} , p \\ge 2$ be a subset of candidate genetic variants G. Suppose that Assumptions $^ { l }$ and 2, and the size of participants $n \\to \\infty$ hold. If each $G _ { j } \\in \\mathbb { G }$ satisfies\n\n$$\n\\operatorname { c o r r } ( { \\mathcal { P R } } _ { ( X , Y \\mid \\mathbb { G } \\backslash G _ { j } ) } , G _ { j } ) = 0 ,\n$$\n\n$\\mathbb { G }$ is a proper valid IV set for one of the causal relationships, i.e., $\\mathbb { G } \\subseteq \\mathbf { G } _ { \\mathcal { V } } ^ { X \\to Y } o r \\mathbb { G } \\subseteq \\mathbf { G } _ { \\mathcal { V } } ^ { Y \\to X } .$\n\nProposition 3 indicates that, under Assumptions 1 and 2, we are able to identify a subset that consists of valid IVs for one of the relationships, from the candidate genetic variants $\\mathbf { G }$ . Here, it should be noted that in a bi-directional MR model (with both $\\beta _ { X  Y } ~ \\neq ~ 0$ and $\\beta _ { Y  X } ~ \\neq ~ 0 ,$ ), one cannot determine whether the identified IV set $\\mathbb { G }$ is related to the causal relationship $X  Y$ or $Y  X$ . To address this, we here introduce the following conditions that allow the estimated valid IV sets to determine the direction.\n\nAssumption 3. In a bi-directional MR model, for a given causal relationship $X  Y$ , $\\beta _ { \\mathrm { X  Y } } ^ { 2 }$ ${ \\bar { t a r } } ( X ) { \\bar { < } } { \\bar { t a r } } ( Y )$ . Similarly, for a given causal relationship $Y  X$ , $\\beta _ { \\mathrm { Y  X } } ^ { 2 } \\cdot \\mathrm { \\bar { ~ } } W a r ( Y ) \\leq V a r \\mathrm { \\bar { ( } } X \\mathrm { \\bar { ~ } } X \\mathrm { \\bar { ~ } }$ .\n\nAssumption 3 is a very natural condition that one expects to hold for the unique identifiability of valid IVs for the bi-directional model. This assumption is often reasonable in MR models as discussed in Xue and Pan [2020]. One may refer to Pages $4 { \\sim } 5$ in Xue and Pan [2020] for more details.\n\nProposition 4 (Identifying Direction of Causal Influences). Suppose Assumption 3 holds. Given $a$ valid $I V$ set denoted as $\\mathbb { G }$ , if each $G _ { j } \\in \\mathbb { G }$ satisfies the condition $| \\mathrm { c o r r } ( G _ { j } , \\mathbf { \\bar { Y } } ) / \\mathrm { c o r r } ( G _ { j } , X ) | < 1$ , then $\\mathbb { G }$ is a valid $I V$ set for the causal relationship $X  Y _ {  }$ , i.e., $\\mathbb { G } \\subseteq \\mathbf { G } _ { \\mathcal { V } } ^ { \\bar { X } \\to Y }$ . Conversely, if this condition is not satisfied, $\\mathbb { G }$ is a valid $I V$ set for the causal relationship $Y  X$ , i.e., $\\mathbb { G } \\subseteq \\mathbf { G } _ { \\nu } ^ { Y  X }$ .\n\nProposition 4 indicates that, under Assumption 3, it is possible to ascertain the directional orientation of the identified IV sets. Thus, with Propositions $2 { \\sim } 4$ , we have sufficient and necessary conditions under which the bi-directional MR model is fully identifiable, formalized as follows:\n\nTheorem 1 (Identifiability of Bi-directional MR model). Suppose that Assumptions $I \\sim 3 _ { ; }$ , and the size of participants $n  \\infty$ hold, the $B i$ -directional MR model is fully identifiable, which includes the identification of valid $I V$ sets, the causal relationships the identified sets relate to, the causal directions between $X$ and $Y$ , and the causal effects of $X$ on $Y$ as well as of $Y$ on $X$ .\n\n# PReBiM Algorithm\n\nIn this section, we leverage the above theoretical results and propose a data-driven algorithm, PReBiM (Pseudo-Residual-based Bi-directional MR), for estimating the causal effects of interest. It contains two key steps, finding valid IV sets (Step I), and inferring causal direction and estimating the causal effects given the identified valid IV sets (Step II). The algorithm is designed with the following rules, which are proved correct: (1) valid IV sets can be correctly discovered given the measured genetic variants (Section 4.1), and (2) the causal direction and causal effects can be uniquely identified (Section 4.2). The entire process is summarized in Algorithm 1.\n\n# Algorithm 1 PReBiM\n\n<html><body><table><tr><td>Input: A dataset of measured genetic variants G = (G1,., Gg)T, two phenotypes X and Y, significance level α,and parameter W,maximum number of IVs to consider.</td><td></td></tr><tr><td>1: Valid IV sets V ← FindValidIVSets(G,X,Y,α,W);</td><td>>StepI</td></tr><tr><td>2: (βx→Y,βy→x） ←InferCausalDirectionEffects(X,Y,V);</td><td>>StepI</td></tr><tr><td>Output: βx→Y and βy→x, the causal effects of X on Y and Y on X,respectively.</td><td></td></tr></table></body></html>\n\n# 4.1 Step I: Finding Valid IV Sets\n\nPropositions 2 and 3 have paved the way to distinguish the invalid and valid IV sets, respectively. This enables us to use a cluster fusion-like method to discover the valid IV sets4. To improve the algorithm’s effectiveness with a finite sample size, especially when the pool of candidate genetic variants $\\mathbf { G }$ is substantial, we introduce a parameter $W$ , representing the maximum number of instrumental variables (IVs) to consider. This approach aims to circumvent the necessity of identifying the largest IV set within the collection, thereby minimizing the need for IV validity testing.\n\nThe basic process is provided in Algorithm 2. Due to limited space, the specific details of algorithm execution are provided in Appendix E. In practice, we check for the valid IV test, i.e., Eq.(10), with the Pearson Correlation Test using the Fisher transformation [Anderson, 2003], denoted by PCT.\n\n# Algorithm 2 FindValidIVSets\n\nInput: A dataset of measured genetic variants $\\mathbf { G } = ( G _ { 1 } , . . . , G _ { g } ) ^ { \\intercal }$ , two phenotypes $X$ and $Y$ , significance level $\\alpha$ , and parameter $W$ , maximum number of $\\mathrm { I V s }$ to consider.   \n1. Initialize valid IV sets $\\nu = \\emptyset$ and $\\tilde { \\mathbf { G } } = \\mathbf { G }$ .   \n2. Find $\\mathcal { V } _ { n e w }$ with $| \\mathbb { G } | = 2$ according to minimize the sum of correlation between pseudo-residual $\\mathcal { P R } _ { ( X , Y \\mid \\mathbb { G } \\backslash G _ { i } ) }$ and $G _ { i }$ , where $G _ { i } \\in \\mathbb { G }$ and $\\mathbb { G } \\in \\tilde { \\mathbf { G } }$ .   \n3. Update $\\mathcal { V } _ { \\mathrm { n e w } }$ by incrementally adding genetic variant $G _ { k }$ until it is impossible to add variables without passing PCT or the length of the set $\\mathcal { V } _ { \\mathrm { n e w } }$ reaches our predetermined threshold $W$ .   \n4. Repeat Step 1 and Step 2 to find another $\\mathcal { V } _ { \\mathrm { n e w } } ^ { \\prime }$ . If $\\nu$ is empty, add $\\mathcal { V } _ { \\mathrm { n e w } } ^ { \\prime }$ to $\\nu$ . If not, and the combined set $\\{ \\mathcal { V } \\cup \\bar { \\mathcal { V } } _ { \\mathrm { n e w } } ^ { \\prime } \\}$ passes the PCT, merge them; otherwise, discard $\\mathcal { V } _ { \\mathrm { n e w } } ^ { \\prime }$ . Stop the iteration when $\\nu$ contains two sets of $\\mathrm { I V s }$ or when there is one or fewer genetic variants left in $\\tilde { \\mathbf { G } }$ .\n\nOutput: $\\nu$ , a set that collects the valid IV sets.\n\n# 4.2 Step II: Inferring Causal Direction and Estimating the Causal Effects\n\nIn this section, we infer the causal direction and estimate the causal effects given the identified valid IV sets. The basic process is provided in Algorithm 3. Due to limited space, the specific details of algorithm execution are provided in Appendix F.\n\n# Algorithm 3 InferCausalDirectionEffects\n\nInput: Two phenotypes $X$ and $Y$ , Valid IV sets $\\nu$ .   \n1. Infer the causal direction corresponding to the valid IV set $\\nu$ based on Proposition 4. 2. Calculate the final causal effects ${ \\hat { \\beta } } _ { X  Y }$ and $\\hat { \\beta } _ { Y  X }$ by TSLS( ).   \nOutput: ${ \\hat { \\beta } } _ { X  Y }$ and ${ \\hat { \\beta } } _ { Y  X }$\n\n# 4.3 Correctness of PReBiM Algorithm\n\nIn this section, we show that, in the large sample limit, for the causal relationships of interest $X  Y$ the causal effects ${ \\hat { \\beta } } _ { X  Y }$ and ${ \\hat { \\beta } } _ { Y  X }$ obtained through the proposed method are unbiased.\n\nTheorem 2 (Correctness). Assume that the data $\\{ X , Y \\}$ and $\\mathbf { G }$ strictly follow Eq.(1) and Assumptions $l \\sim 3$ hold. Given infinite samples, the PReBiM algorithm outputs the true causal effects $\\beta _ { X  Y }$ and $\\beta _ { Y  X }$ correctly.\n\n# 4.4 Complexity of PReBiM Algorithm\n\nWe give the computational complexity analysis as follows. First, the complexity of finding a valid IV set $\\mathcal { V } _ { n e w }$ of length 2 is $\\mathcal { O } \\dot { ( } 2 ( ^ { g } _ { 2 } ) \\big )$ , where $g$ is the number of IVs. Then, the complexity of expanding Vnew to the length W is O \u0010(2g−W −2 )(W −1)\u0011, where $W$ is the maximum length of the IV set. For finding additional valid IV sets, the number of loops, $t$ , must satisfy $\\begin{array} { l l l } { t } & { \\leq } & { { \\frac { g - 4 } { W } } } \\end{array}$ . The complexity of finding the second valid IV set of length $W$ is given by $\\begin{array} { r } { \\ O \\left( \\sum _ { k = 1 } ^ { t } \\left( 2 { \\binom { g - k W } { 2 } } + \\frac { ( 2 g - ( 2 k + 1 ) W - 2 ) ( W - 1 ) } { 2 } \\right) + 2 W ( t - 1 ) + 1 \\right) } \\end{array}$\n\nTherefore, the total computational complexity of the PReBiM algorithm is $\\begin{array} { r } { \\mathcal { O } \\left( \\sum _ { k = 0 } ^ { t } \\left( 2 { \\binom { g - k W } { 2 } } + \\frac { ( 2 g - ( 2 k + 1 ) W - 2 ) ( W - 1 ) } { 2 } \\right) \\dot { + } 2 W ( t - 1 ) + 1 \\right) . } \\end{array}$ .\n\n# 5 Discussion\n\nThe preceding sections demonstrate that a valid IV set can be identified when any two genetic variants in $\\mathbf { G }$ are independent. In this section, we explore whether the main results of Propositions 2 and 3 remain applicable when some genetic variants in $\\mathbf { G }$ are dependent. As shown in Figure 4 (b), we evaluate the condition of Proposition 2 and find that $\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y , | G _ { 2 } ) } , G _ { 1 } ) \\neq$ 0 and $\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y , | G _ { 1 } ) } , G _ { 2 } ) \\neq 0$ . This indicates that $\\{ G _ { 1 } , G _ { 2 } \\}$ is an invalid IV set. Conversely, in Figure 4 (a), when assessing the condition of Proposition\n\n$$\n\\overset { G _ { 2 } } { \\underset { G _ { 1 } } { \\uparrow } } \\mathop { \\sum _ { \\substack { ( \\mathbf { a } ) } } } \\overset { \\displaystyle \\bigoplus } {  } \\overset { \\displaystyle G _ { 2 } } { \\underset { G _ { 1 } } { \\uparrow } } \\overset { G _ { 2 } } { \\underset { G _ { 1 } } { \\uparrow } } \\mathop { \\sum _ { \\substack { ( \\mathbf { b } ) } } } \\overset { \\displaystyle \\bigotimes } {  } Y\n$$\n\nFigure 4: Simple examples, where $\\{ \\bar { G } _ { 1 } , G _ { 2 } \\}$ is a valid IV set in (a), whereas invalid in (b).\n\n3, we observe that $\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y , | G _ { 2 } ) } , G _ { 1 } ) \\stackrel { - } { = } 0$ and $\\mathrm { c o r r } ( \\mathcal { P R } _ { ( X , Y , | G _ { 1 } ) } , G _ { 2 } ) = 0 $ , suggesting that $\\{ G _ { 1 } , G _ { 2 } \\}$ is a valid IV set. Consequently, it is interesting to note that even with such dependence between genetic variants, our main results may still be effective in identifying valid IV sets. In Appendix $\\mathrm { H } . 1 \\sim \\mathrm { H } . 2$ , we further demonstrate the practicality of our method for this example. As for the complex scenarios where there is confounding among genetic variants or between the genetic variants and some phenotype, or where there exist genetic variants that are associated with another phenotype while this phenotype causes $X$ and $Y$ , we leave them into our future work.\n\n# 6 Experimental Results\n\nIn this section, we conduct various simulation studies to evaluate the performance of the proposed PReBiM method. The methods we compare against are: 1) NAIVE, the least-squares regression method; 2) MR-Egger [Bowden et al., 2015]; 3) sisVIVE algorithm [Kang et al., 2016] 5; 4) IVTETRAD algorithm[Silva and Shimizu, 2017] 6; 5) TSHT algorithm [Guo et al., 2018] 7; and 6) PReBiM, our method. The second method, MR-Egger, is specifically for MR studies with invalid IVs. The last four methods are capable of handling the one-sample MR model in the presence of unmeasured confounders. Our source code can be found in the Supplementary Materials.\n\nExperimental setup. To compare the performance of these methods in a realistic setting, analogous to Slob and Burgess [2020], the genetic variants are modeled as Single Nucleotide Polymorphisms (SNPs), with a varying minor allele frequency $m a f _ { j }$ , and take values $0 , 1$ , or 2. The minor allele frequencies are drawn from a uniform distribution. Specifically, the data generation process for the bi-directional model is as follows:\n\n$$\n\\begin{array} { r l } & { U = \\mathbf { G } ^ { \\mathsf { T } } \\gamma _ { U } + \\varepsilon _ { 1 } , } \\\\ & { X = Y \\beta _ { Y  X } + \\mathbf { G } ^ { \\mathsf { T } } \\gamma _ { X } + U \\gamma _ { X , U } + \\varepsilon _ { 2 } , } \\\\ & { Y = X \\beta _ { X  Y } + \\mathbf { G } ^ { \\mathsf { T } } \\gamma _ { Y } + U \\gamma _ { Y , U } + \\varepsilon _ { 3 } , } \\\\ & { G _ { i j } \\sim B i n o m i a l ( 2 , m a f _ { j } ) , m a f _ { j } \\sim \\mathcal { U } ( 0 . 1 , 0 . 5 ) , } \\end{array}\n$$\n\nwhere the error terms ${ \\mathrm { ; } } 1 , \\varepsilon _ { 2 } , \\varepsilon _ { 3 }$ each follow an independent normal distribution with mean 0 and unit variance. The causal effects $\\beta _ { Y  X }$ and $\\beta _ { X  Y }$ are generated from a uniform distribution between $[ - 1 , - 0 . 5 ] \\cup [ 0 . 5 , 1 ]$ . Note that by setting $\\beta _ { Y  X } = 0$ in Eq.(12), the data generation process for the one directional model can be obtained.\n\nWe here conducted experiments with the following tasks.\n\n• T1: Sensitivity to Sample Size. We evaluated the impact of different sample sizes: $n = 2 k , 5 k$ , and $1 0 k$ , where $k$ equals $1 , 0 0 0$ .\n\n• T2: Sensitivity to the Number of Valid IVs. We explored three distinct IV combination scenarios: ${ \\mathcal { S } } ( 2 , 2 , 6 )$ , ${ \\mathcal { S } } ( 3 , 3 , 8 )$ , and ${ \\cal S } ( 4 , 4 , 1 0 )$ . The first two elements in the parentheses represent the number of valid instrumental variables for causal relationships $X  Y$ and $Y  X$ , respectively. The last element in the parentheses represents the total number of genetic variants.\n\nFor a comprehensive analysis, we examined the data from the Bi-directional MR model and the One-directional MR model, as detailed in Section 6.1 and 6.2, respectively. For each experimental setting, we repeated the simulation 500 times and averaged the results.\n\nMetrics: We adopted the following evaluation metrics to evaluate the results of all methods.\n\n• (i) Correct-Selecting Rate (CSR): the number of correctly identified valid IVs divided by the total number of genetic variants, for the direction $X  Y$ or $Y  X$ .   \n• (ii) Mean Squared Error (MSE): The squared difference between the estimated causal effect and the true causal effect.\n\nTo further validate the effectiveness and practicality of our algorithm, we have expanded our experimental settings to include additional scenarios such as small sample sizes, different numbers of valid IVs, large-scale datasets, and cases where all IVs are valid. Within these settings, we compare our algorithm with the five aforementioned methods to assess algorithm performance. Detailed experimental results are provided in Appendix $\\mathrm { H } . 3 \\sim \\mathrm { H } . 6$ .\n\n# 6.1 Evaluation on Bi-Directional MR Model\n\nIn this section, we evaluate the performance of six methods on bi-directional MR data, i.e., $\\beta _ { X  Y } ~ \\neq ~ 0$ and $\\beta _ { Y  X } ~ \\neq ~ 0$ . Table 1 summarizes the results of metrics CSR and MSE in a bidirectional MR model with various sample sizes. It is noted that sisVIVE, IV-TETRAD, and TSHT are not specifically designed for the bi-directional model, so we run them in both forward and reverse directions to obtain the corresponding results. As expected, our proposed PReBiM method gives the best results in all three scenarios, with all sample sizes, indicating that it can identify valid IVs and derive consistent causal effects from purely observational data, even without knowledge of the causal direction between $X$ and $Y$ . Furthermore, the performance of the other three comparison methods of selecting IVs was poor, indicating that they are not suitable for bi-directional MR models. The MSE of the NAIVE method does not tend toward 0, indicating that if unobserved confounding is not considered, the estimated causal effect is certainly biased. Similarly, the MSE of MR-Egger is poor if estimated with all instrumental variables.\n\nTable 1: Performance comparison of NAIVE, MR-Egger, sisVIVE, IV-TETRAD, TSHT, and PReBiM in estimating bi-directional MR models across various sample sizes and three scenarios.   \n\n<html><body><table><tr><td colspan=\"2\"></td><td colspan=\"4\">S(2,2,6)</td><td colspan=\"4\">S(3,3,8)</td><td colspan=\"4\">S(4,4,10)</td></tr><tr><td colspan=\"2\"></td><td colspan=\"2\">X→Y</td><td colspan=\"2\">Y→X</td><td colspan=\"2\">X→Y</td><td colspan=\"2\">Y→X</td><td colspan=\"2\">X→Y</td><td colspan=\"2\">Y→X</td></tr><tr><td>Size</td><td>Algorithm</td><td>CSR↑</td><td>MSE↓</td><td>CSR↑</td><td>MSE↓</td><td>CSR↑</td><td>MSE↓</td><td>CSR↑</td><td>MSE↓</td><td>CSR↑</td><td>MSE↓</td><td>CSR↑</td><td>MSE↓</td></tr><tr><td rowspan=\"6\">2k</td><td>NAIVE</td><td></td><td>0.354</td><td></td><td>0.349</td><td></td><td>0.351</td><td>-</td><td>0.320</td><td>1</td><td>0.335</td><td></td><td>0.304</td></tr><tr><td>MR-Egger</td><td></td><td>0.800</td><td>=</td><td>0.734</td><td>=</td><td>0.571</td><td>=</td><td>0.569</td><td></td><td>0.457</td><td>1</td><td>0.494</td></tr><tr><td>sisVIVE</td><td>0.30</td><td>0.398</td><td>0.25</td><td>0.447</td><td>0.34</td><td>0.379</td><td>0.32</td><td>0.379</td><td>0.37</td><td>0.346</td><td>0.38</td><td>0.330</td></tr><tr><td>IV-TETRAD</td><td>0.60</td><td>0.859</td><td>0.30</td><td>0.867</td><td>0.60</td><td>0.773</td><td>0.28</td><td>0.782</td><td>0.67</td><td>0.688</td><td>0.23</td><td>0.622</td></tr><tr><td>TSHT</td><td>0.07</td><td>0.606</td><td>0.06</td><td>0.660</td><td>0.07</td><td>0.549</td><td>0.07</td><td>0.613</td><td>0.12</td><td>0.653</td><td>0.11</td><td>0.689</td></tr><tr><td>PReBiM</td><td>0.85</td><td>0.046</td><td>0.85</td><td>0.070</td><td>0.89</td><td>0.083</td><td>0.87</td><td>0.075</td><td>0.88</td><td>0.039</td><td>0.89</td><td>0.057</td></tr><tr><td rowspan=\"6\">5k</td><td>NAIVE</td><td>-</td><td>0.350</td><td>-</td><td>0.339</td><td></td><td>0.347</td><td>-</td><td>0.319</td><td>1</td><td>0.357</td><td>-</td><td>0.306</td></tr><tr><td>MR-Egger</td><td>=</td><td>0.737</td><td></td><td>0.836</td><td></td><td>0.604</td><td>=</td><td>0.508</td><td></td><td>0.515</td><td></td><td>0.520</td></tr><tr><td>sisVIVE</td><td>0.32</td><td>0.421</td><td>0.30</td><td>0.407</td><td>0.33</td><td>0.378</td><td>0.35</td><td>0.384</td><td>0.39</td><td>0.439</td><td>0.38</td><td>0.365</td></tr><tr><td>IV-TETRAD</td><td>0.62</td><td>0.804</td><td>0.31</td><td>0.844</td><td>0.63</td><td>0.836</td><td>0.29</td><td>0.659</td><td>0.67</td><td>0.686</td><td>0.25</td><td>0.640</td></tr><tr><td>TSHT</td><td>0.04</td><td>0.544</td><td>0.06</td><td>0.565</td><td>0.08</td><td>0.528</td><td>0.06</td><td>0.570</td><td>0.10</td><td>0.549</td><td>0.07</td><td>0.541</td></tr><tr><td>PReBiM</td><td>0.93</td><td>0.020</td><td>0.91</td><td>0.027</td><td>0.90</td><td>0.019</td><td>0.92</td><td>0.020</td><td>0.90</td><td>0.009</td><td>0.91</td><td>0.010</td></tr><tr><td rowspan=\"6\">10k</td><td>NAIVE</td><td>-</td><td>0.366</td><td></td><td>0.348</td><td>-</td><td>0.319</td><td>-</td><td>0.342</td><td>-</td><td>0.349</td><td>-</td><td>0.300</td></tr><tr><td>MR-Egger</td><td>=</td><td>0.800</td><td>=</td><td>0.763</td><td></td><td>0.524</td><td>=</td><td>0.620</td><td>=</td><td>0.487</td><td>=</td><td>0.424</td></tr><tr><td>sisVIVE</td><td>0.31</td><td>0.457</td><td>0.29</td><td>0.503</td><td>0.37</td><td>0.383</td><td>0.31</td><td>0.394</td><td>0.41</td><td>0.399</td><td>0.41</td><td>0.328</td></tr><tr><td>IV-TETRAD</td><td>0.64</td><td>0.811</td><td>0.31</td><td>0.804</td><td>0.64</td><td>0.748</td><td>0.29</td><td>0.696</td><td>0.71</td><td>0.635</td><td>0.24</td><td>0.577</td></tr><tr><td>TSHT</td><td>0.04</td><td>0.449</td><td>0.02</td><td>0.475</td><td>0.05</td><td>0.525</td><td>0.05</td><td>0.466</td><td>0.05</td><td>0.479</td><td>0.07</td><td>0.498</td></tr><tr><td>PReBiM</td><td>0.95</td><td>0.044</td><td>0.93</td><td>0.018</td><td>0.93</td><td>0.026</td><td>0.93</td><td>0.039</td><td>0.93</td><td>0.027</td><td>0.94</td><td>0.011</td></tr></table></body></html>\n\nNote: The symbol \"−\" means methods have no output. \"↑\" means a higher value is better, and vice versa.\n\n# 6.2 Evaluation on One-Directional MR Model\n\nIn this section, we evaluate the performance of six methods on one-directional MR data, e.g., $\\beta _ { X  Y } \\neq 0$ and $\\beta _ { Y  X } = 0$ . For fairness, we assume that the causal direction $X  Y$ is known for all methods. Figure 5 summarizes the results of metrics CSR (solid lines) and MSE (dashed lines) for all methods in a one-directional MR model with different scenarios. As expected, the metrics CSR and MSE of our method approach the expected value as the sample size increases. The overall results are comparable to the IV-TETRAD algorithm and superior to the sisVIVE algorithm and TSHT algorithm. This is because our method, similar to the IV-TETRAD method, requires fewer valid IVs in the system (at least 2), whereas the other two methods require the number of valid IVs that are related to the overall genetic variants, namely the majority rule assumption (over $5 0 \\%$ of the candidate IVs are valid) and plurality rule assumption (the number of valid IVs is larger than any number of invalid IVs). It has been noted that under the IV-TETRAD method for scenario ${ \\mathbf { } } S ( 2 , 0 , \\bar { 6 } )$ , the metrics CSR and MSE outperform our method. This is because the IV-TETRAD method requires a predetermined number of IV sets to be specified in advance, and in this case, we have predetermined the number of valid IVs for it. However, our method does not have this prior information.\n\n![](images/3507dd5ea0e0645c95e697b7ce75c9c9649046bf43909380d10ff3e781f181f9.jpg)  \nFigure 5: Performance comparison of sisVIVE, IV-TETRAD, TSHT, and PReBiM in estimating one-directional MR models across various sample sizes and three scenarios.\n\n# 6.3 Evaluation on Real-World Data\n\nWe first apply our method to analyze the bi-directional causal relationships between obesity and vitamin D status using the GWAS data from Vimaleswaran et al. [2013]. Note that the original data only consists of summary data, and thus we generate individual-level data based on the data generation mechanism described in Eq.(1). The data we used comprises 16 related SNPs as candidate IVs, including seven SNPs associated with obesity (BMI): rs9939609 (FTO), rs2867125 (TMEM18), rs4074134 (BDNF), rs7647305 (ETV5), rs7138803 (FAIM2), rs3101336 (NEGR1), and rs10938397 (GNPDA2); four SNPs related to 25-hydroxyvitamin D (25(OH)D): rs12785878 (DHCR7), rs10741657 (CYP2R1), rs2282679 (GC), and rs6013897 (CYP24A1); and five SNPs associated with BMI and 25(OH)D: rs4498364, rs1381660, rs4549702, rs12760109, and rs77913838. We observed that FTO and FAIM2 serve as valid IVs for the $X  Y$ , while DHCR7 and CYP24A1 are valid IVs for the $Y  X$ , with estimated causal effects of -1.15 and -0.05, respectively. These findings are consistent with those findings in [Vimaleswaran et al., 2013].\n\nNext, we apply our method to analyze the causal effect of institutions on economic development using the Colonial Origins dataset from [Acemoglu et al., 2001]. The data includes eight candidate IVs: absolute latitude (lat_abst), the density of European settlements in 1900 (euro1900), the level of democracy in 1900 (democ1), constitutional constraints in 1900 (cons1), the timing of industrialization (indtime), democracy in 2000 (democ00a), constitutional constraints in 2000 (cons00a), and log-transformed European settler mortality rates (logem4). Our method identifies euro1900 and logem4 as valid IVs, with an estimated causal effect of 0.861, which is consistent with the findings reported in Acemoglu et al. [2001].\n\n# 7 Conclusion\n\nWe investigated the identifiability conditions for the bi-directional MR model using purely observational data. First, we proposed a testable constraint for identifying valid IV sets, and we demonstrated that, under appropriate conditions, these valid IV sets can be partially or even fully identified by checking the proposed constraints. Experimental results on simulation data further verified the effectiveness of our algorithm. Currently, we assume that genetic variants are randomized. Allowing for general dependent genetic variants is a direction for future work. Additionally, while we focus on a linear bi-directional MR model, in future research, we will generalize to address nonlinear or even more complex data.",
    "summary": "{\n    \"core_summary\": \"### 核心概要\\n\\n**问题定义**\\n论文旨在解决从纯观测数据中估计双向孟德尔随机化（MR）因果效应的难题，其中存在无效工具变量和未测量的混杂因素。双向关系在现实场景中普遍存在，理解和分析它们能为复杂系统提供更深入的见解，有助于制定更有效的干预措施和解决方案。然而，现有的大多数MR方法假设单向因果关系，可能无法处理双向关系的情况，且在选择有效工具变量时往往依赖领域知识或专家经验，缺乏精确先验知识时难以选出合适的有效工具变量。\\n\\n**方法概述**\\n论文首先从理论上研究了从观测数据中识别双向MR的问题，给出了正确识别有效工具变量集以使双向MR模型可识别的充要条件，包括一对表型的因果方向。然后，基于识别理论，提出了一种类似聚类融合的PReBiM算法来发现有效工具变量集并估计感兴趣的因果效应。\\n\\n**主要贡献与效果**\\n- 提出了双向MR模型可识别的充要条件，能够正确识别各方向的有效工具变量集和感兴趣的因果效应。\\n- 提出了实用有效的类似聚类融合算法PReBiM进行无偏估计。在双向MR模型的实验中，PReBiM方法在不同样本大小和多种场景下的正确选择率（CSR）和均方误差（MSE）指标均表现优异。如在样本量为10k的S(4,4,10)场景中，X→Y方向PReBiM的CSR达到了0.93，远高于sisVIVE (0.41)、IV - TETRAD (0.71)、TSHT (0.05)等；MSE为0.027，远低于NAIVE (0.349)、MR - Egger (0.487)、sisVIVE (0.399)等。Y→X方向PReBiM的CSR达到了0.94，MSE为0.011，也显著优于其他基线模型。\\n- 大量实验证明了所提算法在MR模型（包括单向和双向）中的有效性。在单向MR模型中，随着样本量增加，PReBiM的CSR和MSE指标接近预期值，整体结果与IV - TETRAD算法相当，优于sisVIVE算法和TSHT算法。在真实世界数据实验中，应用该方法分析肥胖与维生素D状态、制度与经济发展的双向因果关系，结果与已有研究一致。\",\n    \"algorithm_details\": \"### 算法/方案详解\\n\\n**核心思想**\\n通过分析有效和无效工具变量集对相关系数的不同约束，利用伪残差的不相关性质来识别有效工具变量集。在理论上给出了识别有效工具变量集、因果方向和因果效应的充要条件，在此基础上使用类似聚类融合的方法发现有效工具变量集并估计因果效应。具体而言，定义了伪残差来衡量与遗传变量的不相关关系，通过检验特定的相关性判断工具变量集的有效性，并引入相关假设确保有效工具变量集和因果方向的唯一可识别性。\\n\\n**创新点**\\n现有的处理含无效工具变量的MR研究方法大多假设单向因果关系已知，可能无法处理双向关系场景，且部分方法对先验知识要求较高。本文方法不依赖于已知的单向因果关系，能从纯观测数据中识别双向MR模型的有效工具变量集和因果效应，同时引入了一些相对温和的假设，如Assumption 1（存在至少包含两个有效工具变量的有效工具变量集）和Assumption 2（参数处于勒贝格测度非零的集合），降低了对先验知识的依赖。此外，通过理论推导给出了可测试的约束条件来识别有效工具变量集。\\n\\n**具体实现步骤**\\n1. **Step I: Finding Valid IV Sets**：利用Propositions 2（识别无效工具变量集）和3（识别有效工具变量集）区分无效和有效工具变量集，使用类似聚类融合的方法，引入参数W表示考虑的最大工具变量数量。基本过程如下：\\n    - 初始化有效工具变量集ν为空，\\(\\tilde { \\mathbf { G } } = \\mathbf { G }\\)。\\n    - 找到满足最小化伪残差\\(\\mathcal { P R } _ { ( X , Y \\mid \\mathbb { G } \\backslash G _ { i } ) }\\)与\\(G _ { i }\\)之间相关和的\\(\\mathcal { V } _ { n e w }\\)，其中\\(\\vert \\mathbb { G } \\vert = 2\\)。\\n    - 逐步添加遗传变量\\(G _ { k }\\)更新\\(\\mathcal { V } _ { n e w }\\)，直到无法通过PCT（Pearson Correlation Test using the Fisher transformation）检验或达到预定阈值W。\\n    - 重复上述步骤，若ν为空则添加新的\\(\\mathcal { V } _ { n e w }\\)，若不为空且合并集通过PCT检验则合并，否则丢弃。直到ν包含两个工具变量集或\\(\\tilde { \\mathbf { G } }\\)中剩余一个或更少的遗传变量。\\n2. **Step II: Inferring Causal Direction and Estimating the Causal Effects**：\\n    - 根据Proposition 4（识别因果影响方向）推断有效工具变量集对应的因果方向。\\n    - 使用TSLS()计算最终的因果效应\\(\\hat { \\beta } _ { X  Y }\\)和\\(\\hat { \\beta } _ { Y  X }\\)。\\n\\n**案例解析**\\n论文给出了一个简单的例子，假设有2个有效工具变量\\(G _ { 1 }\\)和\\(G _ { 3 }\\)，3个无效工具变量\\(G _ { 2 }\\)、\\(G _ { 4 }\\)和\\(G _ { 5 }\\)。对于有效工具变量集\\(\\mathbf { G } _ { \\mathcal { V } } ^ { X  Y } = ( G _ { 1 } , G _ { 3 } ) ^ { \\intercal }\\)，有\\(\\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 3 } \\} } , G _ { 1 } ) = 0\\)和\\(\\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 1 } \\} } , G _ { 3 } ) = 0\\)；对于无效工具变量集\\(\\mathbf { G } _ { \\mathcal { T } } ^ { X  Y } = ( G _ { 2 } , G _ { 4 } , G _ { 5 } ) ^ { \\intercal }\\)，有\\(\\mathrm { c o r r } ( Y - X \\omega _ { \\{ G _ { 4 } , G _ { 5 } \\} } , G _ { 2 } ) \\neq 0\\)等。通过这些不同的约束可以区分有效和无效工具变量集。\",\n    \"comparative_analysis\": \"### 对比实验分析\\n\\n**基线模型**\\n- NAIVE：最小二乘回归方法。\\n- MR - Egger [Bowden et al., 2015]，专门用于处理存在无效工具变量的MR研究的方法。\\n- sisVIVE算法 [Kang et al., 2016]。\\n- IVTETRAD算法 [Silva and Shimizu, 2017]。\\n- TSHT算法 [Guo et al., 2018]。\\n\\n**性能对比**\\n*   **在 [正确选择率/Correct - Selecting Rate (CSR)] 指标上：** 在双向MR模型中，对于不同样本大小和多种场景，本文的PReBiM方法在X→Y和Y→X方向的CSR均表现优异。如在样本量为10k的S(4,4,10)场景中，X→Y方向PReBiM达到了 **0.93**，远高于sisVIVE (0.41)、IV - TETRAD (0.71)、TSHT (0.05)等基线模型；Y→X方向PReBiM达到了 **0.94**，也显著优于其他基线模型。在单向MR模型中，随着样本量增加，PReBiM的CSR接近预期值，整体结果与IV - TETRAD算法相当，优于sisVIVE算法和TSHT算法。不过，在IV - TETRAD方法针对场景\\(S ( 2 , 0 , 6 )\\)时，其CSR指标优于PReBiM，这是因为IV - TETRAD方法需要预先指定IV集的数量，而PReBiM方法没有此先验信息。\\n*   **在 [均方误差/Mean Squared Error (MSE)] 指标上：** 在双向MR模型中，PReBiM方法的MSE在不同样本大小和场景下均明显低于其他基线模型。如在样本量为10k的S(4,4,10)场景中，X→Y方向PReBiM的MSE为 **0.027**，远低于NAIVE (0.349)、MR - Egger (0.487)、sisVIVE (0.399)等基线模型；Y→X方向PReBiM的MSE为 **0.011**，同样显著优于其他基线模型。在单向MR模型中，PReBiM的MSE随着样本量增加接近预期值，整体结果与IV - TETRAD算法相当，优于sisVIVE算法和TSHT算法。\",\n    \"keywords\": \"### 关键词\\n\\n- 双向孟德尔随机化 (Bi-Directional Mendelian Randomization, Bi-Directional MR)\\n- 因果效应估计 (Causal Effect Estimation, N/A)\\n- 有效工具变量识别 (Valid Instrumental Variables Identification, N/A)\\n- PReBiM算法 (PReBiM Algorithm, N/A)\\n- 生物医学研究 (Biomedical Research, N/A)\\n- 社会经济学研究 (Socioeconomic Research, N/A)\"\n}"
}