# Identifying Macro Conditional Independencies and Macro Total Effects in Summary Causal Graphs with Latent Confounding

Simon Ferreira1, 2, Charles K. Assaad1

1Sorbonne Universite´, INSERM, Institut Pierre Louis d’Epide´miologie et de Sante´ Publique, F75012, Paris, France 2ENS de Lyon, F69342, Lyon, France simon.ferreira $@$ sorbonne-universite.fr, charles.assaad@inserm.fr

# Abstract

Understanding causal relations in dynamic systems is essential in epidemiology. While causal inference methods have been extensively studied, they often rely on fully specified causal graphs, which may not always be available in complex dynamic systems. Partially specified causal graphs, and in particular summary causal graphs (SCGs), provide a simplified representation of causal relations between time series when working spacio-temporal data, omitting temporal information and focusing on causal structures between clusters of of temporal variables. Unlike fully specified causal graphs, SCGs can contain cycles, which complicate their analysis and interpretation. In addition, their cluster-based nature introduces new challenges concerning the types of queries of interest: macro queries, which involve relationships between clusters represented as vertices in the graph, and micro queries, which pertain to relationships between variables that are not directly visible through the vertices of the graph. In this paper, we first clearly distinguish between macro conditional independencies and micro conditional independencies and between macro total effects and micro total effects. Then, we demonstrate the soundness and completeness of the $d$ -separation to identify macro conditional independencies in SCGs. Furthermore, we establish that the docalculus is sound and complete for identifying macro total effects in SCGs. Finally, we give a graphical characterization for the non-identifiability of macro total effects in SCGs.

# Introduction

In observational studies, causal graphs are vital for decisionmaking regarding interventions and can be useful for detecting independencies between variables. Several standard tools have been developed for fully specified causal graphs, typically represented as directed acyclic graphs (DAGs) or acyclic directed mixed graphs (ADMGs). For example, dseparation (Pearl 1988) enables the detection of conditional independencies directly from the graph. Similarly, the docalculus (Pearl 1995) allows for the derivation of total effect estimands from observational data. These results were also extended to directed mixed graphs (DMGs) (Richardson 1997; Forre´ and Mooij 2017, 2018; Forre´ and Mooij 2020). However, constructing a fully specified causal graph is challenging because it requires knowledge of the causal relations among all pairs of observed variables. This knowledge is often unavailable, particularly in complex, high-dimensional settings, thus limiting the applicability of causal inference theory and tools. Therefore, recently there has been more interest in partially specified causal graphs (Perkovic 2020; Anand et al. 2023; Ferreira and Assaad 2024; Assaad et al. 2024). An important type of partially specified graphs is the cluster-DMG which provides a coarser representation of causal relations through vertices that represent a cluster of variables (and can contain cycles). The partial specification of cluster-DMG arises from the fact that each vertex in an cluster-DMG represents a cluster of variables. A well-known special case of cluster-DMGs is the clusterADMG, which imposes an acyclicity assumption on the graph (Anand et al. 2023). Another notable special case of cluster-DMGs in dynamic systems is the summary causal graph (SCG), where each cluster represents one time series in spacio-temporal data or repeated measurements through time of the same variable in a longitudinal study, and all temporal information is omitted from the graph (Assaad, Devijver, and Gaussier 2022).

In SCGs (or any cluster-DMG), there are two primary types of queries of interest. The first, called a micro query, involves considering one or a few specific variables (but not all) represented by a vertex in an SCG. The second, called a macro query, involves considering the whole cluster of variables represented by a vertex in an SCG. This paper focuses on two types of macro queries: macro conditional independencies and macro total effects. Specifically, we show that the d-separation criterion and the do-calculus respectively identify macro conditional independencies and macro total effects in SCGs. By addressing these macro queries, we aim to provide practical solutions for inferring causal effects in real-world applications where causal relations are only partially understood. In particular, the concept of macro queries is crucial for public health strategies and epidemiological modeling. For example, the macro total effect can be used to understand the impact of the COVID-19 pandemic on the flu epidemic and vice versa (Boe¨lle et al. 2020; Ferguson, Galvani, and Bush 2003), shedding light on the broader impacts of interventions and natural immunity dynamics over extended periods. Note that we assume having access to spacio-temporal data with full time series, i.e., where the coverage from the beginning of generative process is ensured. However, this does not significantly limit the applicability of our results as epidemiologists, for example, often rely on this assumption when analyzing the impact of the COVID-19 pandemic on concurrent epidemics (Feng et al. 2021). While this assumption is not made explicit in such studies, it remains essential for ensuring the validity of such findings. Furthermore, presenting our results along with a clear articulation of this assumption establishes a solid foundation for future work to address this limitation, which is often overlooked in practical applications.

![](images/614236e3fdea7cd34e7a18e01c3611ae2a65cf0fc2942df0b14405b26f62f2aa.jpg)  
Figure 1: An SCG with two compatible FT-ADMGs. Each pair of red and blue vertices represents the macro query we ar interested in.

The remainder of the paper is organized as follows: Firstly, we formally presents SCGs as well as micro and macro queries. Secondly, we show that d-separation is sound and complete for macro conditional independencies in SCGs. Thirdly, we show that the do-calculus is sound and complete for macro total effects in SCGs and present a graphical characterization for the non-identifiability of these effects. After that, we discuss related works. Finally, we conclude the paper while showing its limitations.

# Summary Causal Graphs and Macro Queries

We suppose that in a dynamic system, observations are generated from a discrete-time dynamic structural causal model (DTDSCM), an extension of structural causal models (Pearl 2009) to dynamic systems. In the following we use the convention that uppercase letters represent variables and lowercase letters represent their values, moreover letters in blackboard bold represent sets.

Definition 1 (Discrete-time dynamic structural causal model (DTDSCM)). A discrete-time dynamic structural causal model is a tuple $\mathcal { M } = ( \mathbb { L } , \mathbb { V } , \mathbb { F } , \operatorname* { P r } ( \mathbb { I } ) )$ , where $\mathbb { L } = \bigcup \{ \mathbb { L } ^ { v _ { t } ^ { i } } \mid$ $i \in [ 1 , d ] , t \in [ t _ { 0 } , t _ { m a x } ] \}$ is a set(o)f)exogenous =va⋃ri{ables,∣ wh∈ic[h ca]nnot∈ b[e observ]e}d but affect the rest of the model. $\mathbb { V } = \bigcup \{ \mathbb { V } ^ { i } \mid i \in [ 1 , d ] \}$ such that $\forall i \in [ 1 , d ] , \mathbb { V } ^ { \bar { i } } = \{ V _ { t } ^ { i } \mid t \in$ $\big [ t _ { 0 } , t _ { m a x } \big ] \big \}$ , is∈a[set ]of} endogenou∀s v∈ar[iable]s, wh=ich{ a  ob∈- s[erved an]d} every $V _ { t } ^ { i } \in \mathbb { V }$ is functionally dependent on some subset of $\mathbb { L } ^ { v _ { t } ^ { i } } \cup \mathbb { V } _ { \leq t } \backslash \{ V _ { t } ^ { i } \}$ where $\mathbb { V } _ { \le t } = \{ V _ { t ^ { \prime } } ^ { j } \mid j \in [ 1 , d ] , t ^ { \prime } \le$ $t \}$ . F is a set of functions such that for all $V _ { t } ^ { i } \in \mathbb { V } , f ^ { v _ { t } ^ { i } }$ is $a$ mapping from $\mathbb { L } ^ { v _ { t } ^ { i } }$ and a subset of $\mathbb { V } _ { \le t } \backslash \{ V _ { t } ^ { i } \}$ to $V _ { t } ^ { i }$ . $\operatorname* { P r } ( \mathbb { I } )$ is a joint probability distribution over $\mathbb { L }$ .

We suppose that the direct causal relations $\mathbb { F }$ in a DTDSCM can be qualitatively represented by a full-time acyclic directed mixed graph (FT-ADMG), a special case of ADMGs (Richardson 2003), where bidirected dashed arrows represent hidden confounding.

Definition 2 (Full-Time Acyclic Directed Mixed Graph). Consider a DTDSCM $\mathcal { M }$ . The full-time acyclic directed mixed graph (FT-ADMGM) $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ induced by $\mathcal { M }$ is defined in the following way:

$$
\begin{array} { r l } & { \mathbb { E } ^ { 1 } : = \{ X _ { t - \gamma } \to Y _ { t } | \forall Y _ { t } \in \mathbb { V } , X _ { t - \gamma } \in \mathbb { X } \subseteq \mathbb { V } _ { \leq t } \backslash \{ Y _ { t } \} } \\ & { \qquad \quad s u c h t h a t Y _ { t } : = f ^ { y _ { t } } \big ( \mathbb { X } , \mathbb { L } ^ { y _ { t } } \big ) i n \mathcal { M } \} , } \\ & { \mathbb { E } ^ { 2 } : = \{ X _ { t - \gamma }  \dots \to Y _ { t } | \forall X _ { t - \gamma } , Y _ { t } \in \mathbb { V } } \\ & { \qquad \quad s u c h t h a t \mathbb { L } ^ { x _ { t - \gamma } } \not \downarrow _ { \mathrm { P r } } \mathbb { L } ^ { y _ { t } } \} , } \end{array}
$$

In the remainder, we will use the notations of parents, children, ancestors and descendants for FT-ADMGs. Consider an FT-ADMG $\mathcal { G } ~ = ~ \left( \mathbb { V } , \mathbb { E } \right)$ for every vertex $Y _ { t } \in \mathbb { ~  ~ }$ $\mathbb { V }$ we note: $\begin{array} { r c l c r c l } { P a ( Y _ { t } , { \mathcal G } ) } & { = } & { \{ X _ { t ^ { \prime } } } & { \in } & { \mathbb { V } } & { | } & { X _ { t ^ { \prime } } } & { \to } & { Y _ { t } \} } \end{array}$ , $C h ( Y _ { t } , \mathcal { G } ) = \{ X _ { t ^ { \prime } } \in \mathbb { V } | Y _ { t } \to X _ { t ^ { \prime } } \}$ , $A n \big ( Y _ { t } , \mathcal { G } \big ) =$ $\cup _ { n \in \mathbb { N } } P _ { n }$ ) e= $P _ { 0 } = \{ Y _ { t } \}$ ∣d $\textstyle P _ { k + 1 } = \bigcup _ { X _ { t ^ { \prime } } \in P _ { k } } P a ( X _ { t ^ { \prime } } , \mathcal { G } )$ =, $D e ( Y _ { t } , \mathcal { G } ) \ = \ \bigcup _ { n \in \mathbb { N } } C _ { n }$ where $\begin{array} { c c l } { C _ { 0 } } & { = } & { \{ Y _ { t } \} } \end{array}$ and $C _ { k + 1 } =$ $\cup _ { X _ { t ^ { \prime } } \in C _ { k } } C h ( X _ { t ^ { \prime } } , { \mathcal G } )$ .

In many domains, such as epidemiology, it is generally challenging for practitioners to validate, analyze, or even provide an FT-ADMG due to the difficulty in determining the temporal lag between a cause and its effect. However, practitioners can usually provide summary causal graphs, which are compact versions of FT-ADMG. These summary causal graphs represent the causal relations between the exposure, the disease and the different factors without specifying the temporal lags of these relations.

Definition 3 (Summary Causal Graph with possible latent confounding). Consider an FT-ADMG $\mathcal { G } ~ = ~ \left( \mathbb { V } , \mathbb { E } \right)$ . The summary causal graph (SCG) $\mathcal { G } ^ { s } = \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ compatible with $\mathcal { G }$ is defined in the following way:

$$
\begin{array} { r l } & { \quad \mathbb { S } : = \{ V ^ { i } = ( V _ { t _ { 0 } } ^ { i } , \cdots , V _ { t _ { m a x } } ^ { i } ) \mid \forall i \in [ 1 , d ] \} , } \\ & { \quad \mathbb { E } ^ { s 1 } : = \{ X \to Y \mid \forall X , Y \in \mathbb { S } , \exists t ^ { \prime } \leq t \in [ t _ { 0 } , t _ { m a x } ] } \end{array}
$$

$$
\mathbb { E } ^ { s 2 } : = \{ X \left. : \right. Y \mid \forall X , Y \in \mathbb { S } , \exists t ^ { \prime } , t \in [ t _ { 0 } , t _ { m a x } ]
$$

where Es Es1 Es2.

The transformation from an FT-ADMG to an SCG can be made explicit using the natural transformation from $\mathbb { V }$ to $\mathbb { S }$ , $\begin{array} { r l r } { \dot { \tau _ { 0 } } } & { { } : } & { ( v _ { t _ { 0 } } ^ { 1 } , \ddot { \cdots } , v _ { t _ { m a x } } ^ { 1 } , \cdots , v _ { t _ { 0 } } ^ { d } , \cdots , v _ { t _ { m a x } } ^ { d } ) \quad \mapsto } \end{array}$ $( ( v _ { t _ { 0 } } ^ { 1 } , \cdots , v _ { t _ { m a x } } ^ { 1 } ) , \cdots , ( v _ { t _ { 0 } } ^ { d } , \cdots , v _ { t _ { m a x } } ^ { d } ) )$ . The abstraction of (S(CGs ⋯entails t)hat⋯, e(ven t⋯hough th)e)re is exactly one SCG compatible with a given FT-ADMG, there are in general several FT-ADMGs compatible with a given SCG. For example, we give in Figure 1 an SCG with two of its compatible FT-ADMGs. While SCGs, like cluster-DMGs, can contain cycles, the cycles in an SCG arise from the partial specificity of the graph. Notice that, like cluster-DMGs, SCGs may have directed cycles and in particular two directed edges oriented in opposite directions, i.e., if in the FT-ADMG we have $X _ { t ^ { \prime } }  Y _ { t }$ and $Y _ { t ^ { \prime \prime } } \to X _ { t }$ then in the SCG we have $X  Y$ and $Y  X$ which we→often write $X  Y$ . However, un→like in clu t→er-DMGs, the cycles in SCGs⇄necessarily arise from the partial specificity of the graph. Moreover, if $\mathcal { G } ^ { s } ~ = ~ \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ and $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ are compatible, we abuse thGe  o=t (tion $\forall V ^ { i } \in \mathbb { S }$ $\mathbb { V } ^ { i } ~ = ~ \{ V _ { t } ^ { i } ~ | ~ t ~ \in ~ \hat { [ } t _ { 0 } , t _ { m a x } ] \}$ given in Definition 1 by writing $\forall V ^ { i } = Y \in \mathbb { S }$ , $\mathbb { V } ^ { Y } = \mathbb { V } ^ { i }$ and $\bar { \forall } \mathbb { Y } \subseteq \mathbb { S }$ , $\mathbb { V } ^ { \mathbb { Y } } = \bigcup _ { Y \in \mathbb { Y } } \mathbb { V } ^ { Y }$ .

In the remain∈der, we will adopt the terminology of parents, children, ancestors, and descendants for SCGs, which are defined in a manner consistent with those used for FTADMGs, i.e., the sets of parents, children, ancestors, and descendants of a vertex $Y$ in an SCG $\mathcal { G } ^ { s }$ are respectively given by $P a ( Y , \mathcal { G } ^ { s } ) , C h ( Y , \mathcal { G } ^ { s } ) , A n ( Y , \mathcal { G } ^ { s } )$ , and $\bar { D e } ( Y , \bar { g } ^ { \dot { s } } )$ . Furthermore, a strongly connected component of $Y$ in $\mathcal { G } ^ { s }$ denoted as $S c c ( V , \mathcal { G } ^ { s } )$ is the set $A n ( Y , \mathcal { G } ^ { s } ) \cap D e ( Y , \mathcal { G } ^ { s } )$ .

In this paper, we focus on two distinct queries in SCGs: one that pertains to finding conditional independencies and another that infers total effects. Each of these queries can be categorized into two types: macro query and micro query. Below, we define micro conditional independency and macro conditional independency.

Definition 4 (Micro conditional independency). A micro independence in the FT-ADMG $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ is a conditional independence between two disjoGint= s(ets of) temporal variables $\mathbb { X } , \mathbb { Y } \subseteq \mathbb { V }$ conditioned on any subset of temporal variables $\mathbb { W } \subseteq \mathbb { V } \backslash ( \mathbb { X } , \mathbb { Y } )$ .

Definition 5 (Macro conditional independency). A macro independence in the FT-ADMG $\mathcal { G } = ( \bar { \mathbb { V } } , \mathbb { E } )$ compatible with the SCG $\mathcal { G } ^ { s } ~ = ~ ( \mathbb { S } , \mathbb { E } ^ { s } )$ is a conGdi=t o(nal i)ndependence between two sets of temporal variables of the form VX and VY for $X , Y \in \mathbb { S }$ conditioned on a subset of temporal variables of the fo m∈ $\mathbb { V } ^ { \mathbb { W } }$ for $\mathbb { W } \subseteq { \mathbb { S } } \backslash \{ X , Y \}$ .

For example, in Figure 1, we are interested to know if there is a macro conditional independence between $X$ and

$Y$ given $W$ in the SCG which means to know if $\{ X _ { t } \mid t \in$ $[ t _ { 0 } , { t _ { m a x } } ] \}$ is independent of $\{ Y _ { t } \ | \ t \ \in \ [ t _ { 0 } , t _ { m a x } ] \}$ g∣iven∈ $\{ W _ { t } \mid t \in [ t _ { 0 } , t _ { m a x } ] \}$ . In contra{st,  ∣mi ∈ro[condition]a}l indep{ende∣nc∈e [query wo]u}ld be of the form: ”is $X _ { t }$ independent of $Y _ { t - 1 }$ given $W _ { t - 1 } ? ^ { \dag }$ .

Note that there exists a fundamental tool called dseparation (Pearl 1988) that serves for deriving conditional independence properties from causal graphs. In the following the d-separation of two subsets $\mathbb { X }$ and $\mathbb { Y }$ conditionally on a third one $\mathbb { W }$ in a graph $\mathcal { G }$ is denoted as $\mathbb { X } \underline { { \sqcup _ { \mathcal { G } } } } \mathbb { Y } \mid \mathbb { W }$ .

Now, we define microGtotal effect and maGcro total effect.

Definition 6 (Micro total effect). A micro total effects in the FT-ADMG $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ is a total effect from a set of temporal variables $\mathbb { X }$ to another set of temporal variables $\mathbb { Y }$ where $\mathbb { X } , \mathbb { Y } \subseteq \mathbb { V }$ , denoted as $\operatorname* { P r } ( \mathbb { Y } = \mathbb { y } \mid d o ( \mathbb { X } = \mathbb { z } ) )$ .

Definition 7 (Macro total effect). $A$ macro total effect in the FT-ADMG $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ compatible with the SCG ${ \mathcal { G } } ^ { s } =$ $\left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ is a totGa =e f(ect fr)om $\mathbb { V } ^ { X }$ to $\mathbb { V } ^ { Y }$ where $X , Y ~ \in ~ \mathbb { S }$ =, (denote)d as $\operatorname* { P r } ( \mathbb { V } ^ { Y } = \mathbb { v } ^ { y } \mid d o ( \mathbb { V } ^ { X } = \mathbb { v } ^ { x } ) )$ .

By a slight abuse of notation, in the remainder we will denote macro total effects as $\operatorname* { P r } \ ( \mathbb { v } ^ { y } \mid \mathbf { d o } ( \mathbb { v } ^ { x } ) )$ . Notice that macro queries are a special case of micro queries.

Similarly, we will also define the micro and macro interventions in the FT-ADMG respectively as $\mathbb { I } ^ { m } \ = \ \{ \mathrm { d o } ( V _ { t } ^ { i } \ =$ $v _ { t } ^ { i } ) \mid i \in [ 1 , d ] , t \in [ t _ { 0 } , t _ { m a x } ] \}$ and ${ \mathbb J } ^ { M } = \{ \mathrm { d o } ( \mathbb { V } ^ { i } = \mathbb { v } ^ { i } ) \ | \ i \ \in$ $[ 1 , d ] \}$ .∈C[onsi]der∈a[lso the c]o}mplete set=o{f in(terv=entio)n∣s  n∈ t[he S]C}G $\mathbb { I } ^ { s } = \{ \mathrm { d o } ( Y = y ) \mid Y \in \bar { \mathbb { S } } \}$ which corresponds to the macro interventions from the point of view of the SCG.

# Remarks

• Previous works considering micro queries (Ferreira and Assaad 2024; Assaad et al. 2024) usually assume stationarity, because it permits the division of a single multivariate time series into multiple instances, thereby facilitating estimation when each time-point represents a single observation. However, when focusing solely on macro queries, this assumption loses its relevance because stationarity offers no distinct advantage. Instead, it is assumed that there are multiple observations available for each temporal variable, i.e., spacio-temporal data, because estimating the macro total effect from just a single observation per variable is infeasible. • This work addresses macro conditional independencies and macro total effects. However, it is worth noting that the results presented for macro total effects, particularly in Section ”Idendification of Macro Total Effects”, are also applicable to macro controlled direct effects (Pearl 2009).

# Identification of Macro Conditional Independencies

In this section, we show that d-separation is sound and complete in SCGs for macro queries. Firstly, since an FT-ADMG is an ADMG, the standard definition of d-separation (Pearl 1998) is directly applicable for FT-ADMG. This definition was introduced for ADMGs and was extended to DMGs in (Forre´ and Mooij 2018) and to cluster-ADMGs in (Anand et al. 2023). But it turned out that it is readily extendable to SCGs, which are a special case of cluster-DMGs.

Definition 8 (d-separation in SCGs). In an SCG $\begin{array} { r l } { \mathcal { G } ^ { s } } & { { } = } \end{array}$ $( \mathbb { S } , \mathbb { E } ^ { s } )$ , a path $\pi = \left. V ^ { p _ { 1 } } , \cdots , V ^ { p _ { n } } \right.$ is said to be block dGby $a$ s(et of v)ertices $\mathbb { W } \subseteq \mathbb { S } \ i f$ :

1. $\exists 1 < i < n$ such that $V ^ { p _ { i - 1 } } { \ast } { \times } V ^ { p _ { i } } \ \to \ V ^ { p _ { i + 1 } }$ or $V ^ { p _ { i - 1 } } \gets$ $V ^ { p _ { i } } {  } V ^ { p _ { i + 1 } }$ and $V ^ { p _ { i } } \in \mathbb { W }$ , or−   
2. 1 $<$ $\mathbf { \chi } _ { i }$ n su∈ch that $V ^ { p _ { i - 1 } } { \LARGE * } V ^ { p _ { i } } { \Lt }  V ^ { p _ { i + 1 } }$ and $D e ( V ^ { p _ { i } } , \mathcal { G } ^ { s } ) \cap \mathbb { W } = \emptyset$ .

where $\nrightarrow$ represents or , $$ represents $ \ : o r \ :  \ :  \ : $ , and $^ *$ r→epresents any→of the three←arrow $t y p e  ,  o r  \quad \xrightarrow { } .$ . A pat−h which is not blocked is said to be active→. A←set $\mathbb { W } \subseteq \mathbb { S }$ is said to $d$ -separate two sets of variables X, $\mathbb { Y } \subseteq \mathbb { S }$ i⊆f it blocks every path from a variable of X to a variable of Y.

Before providing the main results of this section, we define the notion of walks in graphs and show how it is related to the notion of paths. This notion is important in SCGs since they contain cycles and the relation between paths and walks will be useful in the proof of the soundness of d-separation.

A walk is a sequence of consecutively adjacent vertices and contrary to paths, walks may contain repeating vertices. The definition of blocked path given in Definition 8 is readily extendable to walks.

Property 1. (Active Walks) Let $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ be an FT-ADMG, $\mathbb { W } \subseteq \mathbb { V }$ and $\tilde { \pi } = \langle V ^ { 1 } , \cdots , V ^ { n } \rangle _ { . }$ be aG w=a(lk. If)π˜ is $\mathbb { W }$ -active then the⊆re exist a p=at⟨h $\pi$ fr⋯om $V ^ { 1 }$ to $V ^ { n }$ which is $\mathbb { W }$ -active.

Proof. In Appendix.

The following theorem shows that the d-separation as presented in Definition 8 is sound in SCGs.

Theorem 1 (Soundness of d-separation in SCGs). Let $\mathcal { G } ^ { s } =$ $( \mathbb { S } , \mathbb { E } ^ { s } )$ be an SCG and X, Y, $\mathbb { W } \subseteq \mathbb { S } .$ . If $\mathbb { X }$ and $\mathbb { Y }$ arGe $d$ - separated by W in $\mathcal G ^ { s }$ then, in any compatible FT-ADMG $\mathcal { \dot { G } } = ( \mathbb { V } , \mathbb { E } ) , \dot { \mathbb { V } } ^ { \mathbb { X } }$ and $\mathbb { V } ^ { \mathbb { Y } }$ are $d$ -separated by $\mathbb { V } ^ { \mathbb { W } }$ .

Proof. Suppose $\mathbb { X }$ and $\mathbb { Y }$ are d-separated by $\mathbb { W }$ in $\mathcal G ^ { s }$ and there exists a compatible FT-ADMG $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ andGa path $\pi = \big \langle V _ { t ^ { p _ { 1 } } } ^ { p _ { 1 } } , \cdots , V _ { t ^ { p _ { n } } } ^ { p _ { n } } \big \rangle$ from $V _ { t ^ { p _ { 1 } } } ^ { p _ { 1 } } \in \mathbb { V } ^ { \mathbb { Z } }$ tGo $V _ { t ^ { p _ { n } } } ^ { p _ { n } } \in \mathbb { V } ^ { \mathbb { Y } }$ which is not=b⟨locked⋯by $\mathbb { V } ^ { \mathbb { W } }$ . The walk $\tilde { \pi } ^ { s } = \langle V ^ { p _ { 1 } } , \cdots , V ^ { p _ { n } } \rangle$ is in $\mathcal { G } ^ { s }$ with $V ^ { p _ { 1 } } \in \mathbb { X }$ and $V ^ { p _ { n } } \in \mathbb { Y }$ . Since $\mathbb { X }$ a⟨nd $\mathbb { Y }$ ar⋯e d-sep⟩arated Gby $\mathbb { W }$ and usi∈ng the contra∈position of Property $1 , \mathbb { W }$ blocks $\tilde { \pi } ^ { s }$ and thus there exists $1 < i < n$ such that $\left. { \dot { V } } ^ { p _ { i - 1 } } , V ^ { p _ { i } } , V ^ { p _ { i + 1 } } \right.$ is $\mathbb { W }$ -blocked.

If $V ^ { p _ { i - 1 } } { * + } V ^ { p _ { i } }  V ^ { p _ { i + 1 } }$ (or symmetrically $V ^ { p _ { i - 1 } } $ $V ^ { p _ { i } } { * * } V ^ { p _ { i + 1 } } )$ and $V ^ { p _ { i } } \in \mathbb { W }$ then $V _ { t ^ { p _ { i - 1 } } } ^ { \bar { p _ { i - 1 } } } { * * V _ { t ^ { p _ { i } } } ^ { p _ { i } } } \ \stackrel { \cdot } {  } \ V _ { t ^ { p _ { i + 1 } } } ^ { p _ { i + 1 } }$ an←d $\forall t \ \in \ \left[ t _ { 0 } , t _ { m a x } \right]$ , $V _ { t } ^ { p _ { i } } \in \mathbb { V } ^ { \mathbb { W } }$ and in pa−rticul r→ $V _ { t ^ { p _ { i } } } ^ { p _ { i } } \ \in \ \mathbb { V } ^ { \mathbb { W } }$ . T∀h r∈ef[ore, $\pi$ is ]blocked∈by $\mathbb { V } ^ { \mathbb { W } }$ .

Otherwise, $V ^ { p _ { i - 1 } } {  } V ^ { p _ { i } } {  } V ^ { p _ { i + 1 } }$ and $D e ( V ^ { p _ { i } } , \mathcal { G } ^ { s } ) \cap \mathbb { W } =$ $\varnothing$ so $V _ { t ^ { p _ { i - 1 } } } ^ { p _ { i - 1 } } {  } V _ { t ^ { p _ { i } } } ^ { p _ { i } } {  } V _ { t ^ { p _ { i + 1 } } } ^ { p _ { i + 1 } }$ and $D e ( V _ { t ^ { p _ { i } } } ^ { p _ { i } } , \mathcal { G } ) \cap \mathbb { V } ^ { \mathbb { W } } \subseteq$ $\mathbb { V } ^ { D e s c ( V ^ { p _ { i } } ) } \cap \mathbb { V } ^ { \mathbb { W } } = \{ \mathbb { V } ^ { j } \mid V ^ { j } \in D e ( V ^ { p _ { i } } , \mathcal { G } ^ { s } ) \cap \mathbb { W } \} = \{ \mathbb { V } ^ { j } \mid { \cal V } ^ { j } \in { \cal D } ^ { j } \}$ $V ^ { j } \in \mathcal { O } \} = \mathcal { O }$ . The=ref{ore, $\pi$ is b∈lock(ed by $\mathbb { V } ^ { \mathbb { W } }$ ∩whic}h =co{ntra-∣ dicts∈ t∅he} i=nit∅ial assumption. In conclusion, the ${ \mathrm { d } }$ -separation criterion in SCGs is sound. □

The following theorem shows that the d-separation as presented in Definition 8 is complete in SCGs.

Theorem 2 (Completeness of d-separation in SCGs). Let $\mathcal { G } ^ { s } = \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ be an SCG and $\mathbb { X }$ , Y, $\mathbb { W } \subseteq \mathbb { S }$ . $I f \mathbb { X }$ and Y are not $d$ -se=p(arated)by $\mathbb { W }$ in $\mathcal G ^ { s }$ then, there ex⊆ists a compatible FTADMG $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ sucGh that $\mathbb { V } ^ { \mathbb { X } }$ and $\mathbb { V } ^ { \mathbb { Y } }$ are not $d$ -separated by $\mathbb { V } ^ { \mathbb { W } }$ .

Proof. Suppose $\mathbb { X }$ and $\mathbb { Y }$ are not d-separated by $\mathbb { W }$ in $\mathcal G ^ { s }$ . Since $\mathbb { X }$ and $\mathbb { Y }$ are not d-separated by $\mathbb { W }$ in $\mathcal G ^ { s }$ there exis sGan $\mathbb { W }$ -active path $\pi ^ { s } = \left. V ^ { p _ { 1 } } , \cdots , V ^ { p _ { n } } \right.$ with $V ^ { p _ { 1 } } \in \mathbb { X }$ and $V ^ { p _ { n } } \in$ Y. From the SCG $\mathcal { G } ^ { s } = \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ o⟩ne can build∈ a compatible∈ FT-ADMG $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ =in(the fo)llowing way:

$$
\mathbb { V } : = \mathbb { V } ^ { \mathbb { S } }
$$

$$
\mathbb { E } _ { \pi ^ { s } } ^ { 1 } : = \{ X _ { t } \to Y _ { t } \mid \forall t \in [ t _ { 0 } , t _ { m a x } ] , \forall X \to Y \in \mathbb { E } ^ { s }
$$

$$
\mathbb { E } _ { \overline { { \pi } } ^ { s } } ^ { 1 } : = \{ X _ { t } \to Y _ { t + 1 } | \forall t \in [ t _ { 0 } , t _ { m a x } [ , \forall X \to Y \in \mathbb { E } ^ { s }
$$

$$
\mathbb { E } _ { \pi ^ { s } } ^ { 2 } : = \{ X _ { t } \left. \dots \right. Y _ { t } | \forall t \in [ t _ { 0 } , t _ { m a x } ] , \forall X \left. \dots \right. Y \in \mathbb { E } ^ { s }
$$

$$
\begin{array} { r l } & { \mathbb { E } _ { \overline { { \pi } } ^ { s } } ^ { 2 } : = \{ X _ { t }  \longrightarrow Y _ { t + 1 } | \forall t \in [ t _ { 0 } , t _ { m a x } [ , \forall X  \mathrm { -- } Y \in \mathbb { E } ^ { s } } \\ & { \qquad \mathrm { s u c h ~ t h a t } \langle X  \mathrm { -- } Y \rangle \not \in \pi ^ { s } \mathrm { ~ a n d } \langle Y  \mathrm { -- } X \rangle \not \in \pi ^ { s } \} } \\ & { \mathbb { E } : = \mathbb { E } _ { \pi ^ { s } } ^ { 1 } \cup \mathbb { E } _ { \overline { { \pi } } ^ { s } } ^ { 1 } \cup \mathbb { E } _ { \pi ^ { s } } ^ { 2 } \cup \mathbb { E } _ { \overline { { \pi } } ^ { s } } ^ { 2 } } \end{array}
$$

Notice that $\mathcal { G }$ is in indeed acyclic, contains no edges going back in iGme and is compatible with the SCG $\mathcal G ^ { s }$ . Moreover, $\mathcal { G }$ contains the path $\overline { { \pi } } ^ { \circ } = \big \langle V _ { t _ { 0 } } ^ { p _ { 1 } } , \cdots , V _ { t _ { 0 } } ^ { p _ { n } } \big \rangle$ whiGch is necessarily $\mathbb { V } ^ { \mathbb { W } }$ -active since $\pi ^ { s }$ is $\mathbb { W }$ -active. I conclusion, the d-separation criterion in SCGs is complete. □

The findings of this section establish that identifying a dseparation in SCGs guarantees a macro-level d-separation in all compatible FT-ADMGs. This is crucial because, as shown in Pearl 2009, a ${ \mathrm { d } }$ -separation in an ADMG implies a conditional independence in the underlying probability distribution. By extending the applicability of d-separation to SCGs, this result allows researchers to infer macro-level conditional independencies even when dealing with partially specified graphs that omit specific temporal information. This is particularly valuable in constraint-based causal discovery when the interest is to uncover the structure of the SCG without uncovering an FT-ADMG.

# Identification of Macro Total Effects

The do-calculus initially introduced in Pearl 1995 is an important tool of causal inference that consists of three rules. It allows to express, whenever it is possible, queries under interventions, i.e., that contains a $\mathrm { d o } ( \cdot )$ operator, as queries that can be computed from positive observational1 distribution, i.e., that does not contain a $\mathrm { d o } ( \cdot )$ operator. In such cases, it is said that the query containin(g⋅)the $\mathrm { d o } ( \cdot )$ is identifiable. The do-calculus was initially introduced (f⋅o)r ADMGs so it is not easily extendable to cyclic graphs. But it turned out that it is readily extendable to SCGs (containing cycles).

![](images/082f99de9eb7d09282219f5ecc3cdb83cfcde14902635b1d2ec26c09ec8324ef.jpg)  
Figure 2: SCGs with identifiable macro total effects. Each pair of red and blue vertices represents the total effect we are interested in.

Firstly, we define the notion of mutilated graphs (Pearl 2009). Consider a causal graph $\mathcal { G } = ( \mathbb { V } , \mathbb { E } )$ and $\mathbb { A } , \mathbb { B } \subseteq \mathbb { V }$ , a mutilated graph denoted by $\mathcal { G } _ { \bar { \mathbb { A } } \mathbb { B } }$ s= (he gr)aph obtaine⊆d by removing all edges coming in A a¯nd all edges coming out of B. In the following, we introduce a property of compatibility between mutilated graphs that will be useful for proving the soundness and the completeness of the do-calculus in SCGs.

Property 2. (Compatibility of Mutilated Graphs) Let $\mathcal { G } =$ $( \mathbb { V } , \bar { \mathbb { E } } )$ be an FT-ADMG, $\dot { \mathcal { G } ^ { s } } = \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ its compatible $S C G$ (and A), $\mathbb { B } \subseteq \mathbb { S }$ . The mutila eGd g=ra(ph $\mathcal { G } _ { \mathbb { A B } } ^ { s }$ is an SCG compatible with  h⊆e mutilated FT-ADMG G¯A ¯B .

Proof. In Appendix.

Using the notion of mutilated graphs and d-separation we show that the do-calculus is applicable to SCGs.

Theorem 3 (Soundness of the do-calculus). Let $\begin{array} { r l } { \mathcal { G } ^ { s } } & { { } = } \end{array}$ $( \mathbb { S } , \mathbb { E } ^ { s } )$ be an SCG and $\mathbb { X } , \mathbb { Y } , \mathbb { U } , \mathbb { W } \subseteq \mathbb { S }$ be disjoint subsets (of vert)ices. The three following rules⊆of the do-calculus are sound.

$$
\begin{array} { r l } & { I \colon \operatorname* { P r } ( \mathbb { v } ^ { y } \mid d o ( \mathbb { v } ^ { \mathfrak { u } } ) , \mathbb { v } ^ { \mathbb { s } } , \mathbb { v } ^ { \mathbb { s } } ) = \operatorname* { P r } ( \mathbb { v } ^ { y } \mid d o ( \mathbb { v } ^ { \mathfrak { u } } ) , \mathbb { v } ^ { \mathbb { s } } ) } \\ & { \quad i f \mathbb { Y } \mathbb { 1 } _ { \mathbb { Q } _ { \mathbb { s } } ^ { \mathtt { s } } } \mathbb { X } \mid \mathbb { U } , \mathbb { W } } \\ & { 2 \colon \operatorname* { P r } ( \mathbb { v } ^ { y } \mid d o ( \mathbb { v } ^ { \mathfrak { u } } ) , d o ( \mathbb { v } ^ { \mathfrak { u } } ) , \mathbb { v } ^ { \mathbb { s } } ) = \operatorname* { P r } ( \mathbb { v } ^ { y } \mid d o ( \mathbb { v } ^ { \mathfrak { u } } ) , \mathbb { v } ^ { \mathbb { s } } , \mathbb { v } ^ { \mathbb { s } } ) } \\ & { \quad i f \mathbb { Y } \mathbb { 1 } _ { \mathbb { Q } _ { \mathbb { s } _ { \mathbb { s } } ^ { s } } } \mathbb { X } \mid \mathbb { U } , \mathbb { W } } \\ & { 3 \colon \operatorname* { P r } ( \mathbb { v } ^ { y } \mid d o ( \mathbb { v } ^ { \mathfrak { u } } ) , d o ( \mathbb { v } ^ { \mathfrak { u } } ) , \mathbb { v } ^ { \mathbb { s } } ) = \operatorname* { P r } ( \mathbb { v } ^ { y } \mid d o ( \mathbb { v } ^ { \mathfrak { u } } ) , \mathbb { v } ^ { \mathbb { s } } ) } \\ & { \quad i f \mathbb { Y } \mathbb { 1 } _ { \mathbb { Q } _ { \mathbb { s } \times \mathbb { \{ s } } ^ { s } } } \mathbb { X } \mid \mathbb { U } , \mathbb { W }  \end{array}
$$

where $\mathbb { X } ( \mathbb { W } )$ is the set of vertices in $\mathbb { X }$ that are non-ancestors of any ve(rte)x in $\mathbb { W }$ in the mutilated graph $\mathcal { G } _ { \hat { \mathbb { U } } } ^ { s }$ .

Proof. Let $\mathcal { G } ^ { s } = \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ be an SCG and $\mathbb { X } , \mathbb { Y } , \mathbb { U } , \mathbb { W } \subseteq \mathbb { S }$ .

Suppose tGhat= $\mathbb { Y } \underline { { \sqcup } } _ { \mathcal { G } _ { \mathbb { U } } ^ { s } } \mathbb { X } \ | \ \mathbb { U } , \ \mathbb { W }$ . Using Property 2 a⊆nd Theorem 1 we know that for every compatible FT-ADMG $\mathcal { G }$ , $\mathbb { V } ^ { \mathbb { Y } } \bot \bot \mathcal { G } _ { \mathbb { V } } ^ { \mathbb { W } } \mid \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ . Thus, the usual rule 1 of the dGocalculus given by Pearl 1995 in the case of ADMGs states that $\mathrm { P r } \big ( \tilde { \mathrm { v } ^ { \mathfrak { y } } } \mid \mathrm { d o } \big ( \tilde { \mathrm { v } ^ { \mathfrak { u } } } \big ) , \mathrm { v } ^ { \mathfrak { x } } , \mathrm { v } ^ { \mathfrak { w } } \big ) = \mathrm { P r } \big ( \mathrm { v } ^ { \mathfrak { y } } \mid \mathrm { d o } \big ( \mathrm { v } ^ { \mathfrak { u } } \big ) , \mathrm { v } ^ { \mathfrak { w } } \big )$ .

Supp(ose that( $\mathbb { Y } \underline { { \mathbb { 1 } } } \underline { { \mathcal { G } _ { \bar { \mathbb { U } } \mathbb { X } } ^ { s } } } \mathbb { X } \mid \mathbb { U } , \mathbb { W }$ . (Usi∣ng P(rop)erty )2 and Theorem 1 we know that for every compatible FT-ADMG $\mathcal { G }$ ,

![](images/9b14716334d57fcc3515790bf2f6440dc8b7e483df73875f7c8c619485e03194.jpg)  
Figure 3: SCGs with not identifiable macro total effects. Each pair of red and blue vertices represents the total effect we are interested in.

VY ¯U X VX VU, VW. Thus, the usual rule 2 of the docalculus given by Pearl 1995 in the case of ADMGs states that $\mathrm { P r } ( \mathbb { v } ^ { \mathbb { \tilde { y } } } \mid \mathrm { d o } ( \mathbb { v } ^ { \mathbb { u } } ) , \mathrm { d o } ( \mathbb { v } ^ { \mathbb { z } } ) , \mathbb { v } ^ { \mathbb { w } } ) = \mathrm { P r } ( \mathbb { v } ^ { \mathbb { y } } \mid \mathrm { d o } ( \mathbb { v } ^ { \mathbb { u } } ) , \mathbb { v } ^ { \mathbb { z } } , \mathbb { v } ^ { \mathbb { w } } )$ .

Supp(ose tha(t $\mathbb { Y } \underline { { \sqcup } } _ { \mathcal { G } _ { \mathbb { C } ( \mathbb { V } ) } ^ { s } } \Zmathbb { K } \ | \ \mathbb { U } , \ \mathbb { W }$ . (Us n∣ g P(rop)erty 2, $\mathcal { G } _ { \hat { \mathbb { U } } } ^ { s }$ is compatible with any $\mathcal { G } _ { \bar { \mathbb { V } } ^ { \bar { \mathbb { U } } } }$ and if $\exists X _ { t _ { X } } ~ \in ~ \mathbb { V } ^ { \times }$ such that $X _ { t _ { X } } ~ \in ~ A n ( \mathbb { V } ^ { \mathbb { V } } , \mathcal { G } _ { \mathbb { V } ^ { \mathbb { V } } } )$ then $X ~ \in ~ A n ( \mathbb { W } , \mathcal { G } _ { \hat { \mathbb { U } } } ^ { s } )$ . Therefore, $\forall X \ \in \ \mathbb { X }$ $X \ \notin \ A n ( \mathbb { W } , \mathcal { G } _ { \bar { \mathbb { U } } } ^ { s } ) \ \implies \ \forall X _ { t _ { X } } \ \in \ \mathbb { V } ^ { \times }$ , $X _ { t _ { X } } \notin \left( \begin{array} { l } { \begin{array} { r l } \end{array} } & { \begin{array} { r l } \end{array} } \\ { \begin{array} { r l } \end{array} } \end{array} \right.$ $A n ( \mathbb { V } ^ { \mathbb { X } } , \mathcal { G } _ { \mathbb { V } ^ { \mathbb { U } } } )$ ∉Thus, $\mathcal { G } _ { \bar { \mathbb { U } } \times \bar { ( } \mathbb { W } ) } ^ { s }$ andÔ $\mathcal { G } _ { \bar { \mathbb { V } } ^ { \bar { \mathbb { U } } } \bar { \mathbb { V } } ^ { \times } \bar { ( \mathbb { V } ^ { \mathbb { V } } ) } }$ r∈e compatib ∉, and using Theorem 1 we know that for every compatible FT-ADMG , VY ¯U X¯ W $, \mathbb { V } ^ { \mathbb { Y } } \bot \bot \mathcal { G } _ { \mathbb { V } ^ { \mathbb { V } } \mathbb { V } } \mathbb { V } ^ { \mathbb { X } } \mid \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ . Thus, the usual rule 3 of the do-calculus given by Pearl 1995 in the case of ADMGs states that $\operatorname* { P r } ( \mathbb { v } ^ { \mathbb { y } } \mid \mathbf { d o } ( \mathbb { v } ^ { \mathbb { u } } ) , \mathbf { d o } ( \mathbb { v } ^ { \mathbb { x } } ) , \mathbb { v } ^ { \mathbb { w } } ) = \operatorname* { P r } ( \mathbb { v } ^ { \mathbb { y } } \mid $ $\mathrm { d o } \big ( \mathbb { v } ^ { \mathfrak { u } } \big ) , \mathbb { v } ^ { \mathbb { w } } \big )$ . □

Using the soundness of the do-calculus in SCGs (Theorem 3), we can easily use the rules of the do-calculus to find out that the total effect $\operatorname* { P r } \bigl ( \mathbb { v } ^ { \mathbb { y } } \mid \mathrm { d o } \bigl ( \mathbb { v } ^ { \mathbb { z } } \bigr ) \bigr )$ is identifiable in all SCGs in Figure 2. Both in Figure 2a and $2 \mathrm { c }$ , one can verify that $\mathbb { Y } _ { \underline { { \perp } } \underline { { \vert } } _ { \mathcal { G } _ { \underline { { s } } } } ^ { s } } \mathbb { X }$ , thus Rule 2 of the do-calculus is applicable and $\operatorname* { P r } ( \mathbb { v } ^ { \mathbb { y } } \mid \mathbf { d o } ( \mathbb { v } ^ { \mathbb { x } } ) ) = \operatorname* { P r } ( \mathbb { v } ^ { \mathbb { y } } \mid \mathbb { v } ^ { \mathbb { x } } )$ . Notice that Figure 2b does not contain any cycle other than self-loops and is very similar to Figure 1(b) of (Anand et al. 2023) which corresponds to the well-known front-door criterion (Pearl 2009). Thus, using the corresponding sequence of classical rules of probability and rules of do-calculus as the one given in (Pearl 2009, p.83), one obtains $\begin{array} { r } { \operatorname* { P r } \big ( \mathbb { v } ^ { \mathbb { y } } \mid \mathrm { d o } \big ( \mathbb { v } ^ { \mathbb { x } } \big ) \big ) \ \stackrel { - } { = } \ \sum _ { \mathbb { v } ^ { \mathbb { w } } } \operatorname* { P r } \big ( \mathbb { v } ^ { \mathbb { w } } \ \big \vert } \end{array}$ $\begin{array} { r } { \mathbb { v } ^ { \mathbb { x } } \big ) \sum _ { \mathbb { v } ^ { \mathbb { x } ^ { \prime } } } \operatorname* { P r } ( \mathbb { v } ^ { \mathbb { y } } \ \mid \ \mathbb { v } ^ { \mathbb { w } } , \mathbb { v } ^ { \mathbb { x } ^ { \prime } } ) \operatorname* { P r } ( \mathbb { v } ^ { \mathbb { x } ^ { \prime } } ) } \end{array}$ . In these three examples, the) r∑ules of( do-∣calculus)all(ow )macro interventional distributions to be expressed solely in terms of observational distributions. Consequently, the macro total effect can be estimated from the data, provided the positivity assumption holds.

In the following, we introduce the second main theorem of this section.

Theorem 4 (Completeness of the do-calculus). If one of the do-calculus rules does not apply for a given SCG, then there exists a compatible FT-ADMG for which the corresponding rule does not apply.

Proof. Let $\mathcal { G } ^ { s } = \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ be an SCG and $\mathbb { X } , \mathbb { Y } , \mathbb { U } , \mathbb { W } \subseteq \mathbb { S }$ .

Suppose Gthat= r(ule 1 )does not apply i.e., $\mathbb { Y } \sharp _ { \mathcal { G } _ { \mathbb { U } } ^ { s } } \mathbb { X } \ | \ \mathbb { U } , \mathbb { W }$ . Then, using Theorem 2 there exists an FT-ADMG $\tilde { \mathcal { G } }$ compatible with $\mathcal { G } _ { \mathbb { U } } ^ { s }$ in which $\mathbb { V } ^ { \mathbb { Y } } \sharp _ { \tilde { \mathcal { G } } } \mathbb { V } ^ { \mathbb { X } } \ | \ \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ . NotiGce that there exists an FT-ADMG $\mathcal { G }$ compatible with $\mathcal G ^ { s }$ such that $\mathcal G _ { \bar { \mathbb { V } } ^ { \bar { \mathbb { U } } } } = \tilde { \mathcal G }$ . Therefore, $\mathcal { G }$ is an FT-ADMG compatible with $\mathcal { G } ^ { s }$ in which $\mathbb { V } ^ { \mathbb { V } } \mathbb { H } _ { \mathcal { G } _ { \mathbb { V } } ^ { - } } \mathbb { V } ^ { \mathbb { X } } | \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ and thus the usual rule 1 of the do-calculus given by Pearl 1995 in the case of ADMGs does not apply.

Suppose that rule 2 does not apply i.e., $\mathbb { Y } \sharp g _ { \scriptscriptstyle \oplus \underline { { s } } } \mathbb { X } \ | \ \mathbb { U } , \mathbb { W } .$ . Then, using Theorem 2 there exists an FT-ADMG $\tilde { \mathcal { G } }$ compatible with $\mathcal { G } _ { \mathbb { U } \mathbb { X } } ^ { s }$ in which $\mathbb { V } ^ { \mathbb { Y } } \sharp _ { \tilde { \mathcal { G } } } \mathbb { V } ^ { \mathbb { X } } \ | \ \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ . NotiGce that there exists an F¯T-ADMG $\mathcal { G }$ compatible with $\mathcal G ^ { s }$ such that $\mathcal { G } _ { \mathbb { V } ^ { - } \cup \mathbb { V } ^ { \times } } = \tilde { \mathcal { G } }$ . Therefore, $\mathcal { G }$ isGan FT-ADMG comGpatible with $\mathcal G ^ { s }$ in¯ which $\mathbb { V } ^ { \mathbb { V } } \mathbb { H } _ { \mathcal { G } _ { \mathbb { V } \mathbb { V } } \mathbb { X } } \mathbb { V } ^ { \mathbb { X } } \mid \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ and thus the usual rule 2 of the do-calculus g¯iven by Pearl 1995 in the case of ADMGs does not apply.

Suppose that rule 3 does not apply i.e., $\mathbb { Y } \sharp g _ { \scriptscriptstyle \bar { \mathbb { U } } \times ( \bar { \mathbb { V } } ) } \mathbb { X } | \mathbb { U } , \mathbb { W } .$ Then, using Theorem 2 there exists an FT-ADMG $\tilde { \mathcal { G } }$ compatible with $\mathcal { G } _ { \bar { \mathbb { U } } \times ( \bar { \mathbb { W } } ) } ^ { s }$ in which $\mathbb { V } ^ { \mathbb { Y } } \sharp _ { \tilde { \mathcal { G } } } \mathbb { V } ^ { \mathbb { X } } \ | \ \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ .GUsing the same idea as in) the proof of Theorem 3, notice that there exists an FT-ADMG $\mathcal { G }$ compatible with $\mathcal { G } ^ { s }$ such that $\mathcal { G } _ { \bar { \mathbb { V } } ^ { \bar { \mathbb { U } } } \mathbb { V } \times \bar { ( \mathbb { V } ^ { \mathbb { W } } ) } } = \tilde { \mathcal { G } }$ . Therefore, $\mathcal { G }$ is an FT-ADMG compatible with (s i)n which VY ¯U X ¯ W $\mathbb { V } ^ { \mathbb { Y } } { \mu _ { \mathbb { V } \times ( \mathbb { V } ^ { \mathbb { V } } ) } } \mathbb { V } ^ { \mathbb { X } } \ | \ \mathbb { V } ^ { \mathbb { U } } , \mathbb { V } ^ { \mathbb { W } }$ and thus the usual rule 3 of the do-calcul(us given by Pearl 1995 in the case of ADMGs does not apply. □

Using the completeness of the do-calculus in SCGs (Theorem 4), we can determine that the total effect $\operatorname* { P r } ( \mathbb { v } ^ { \mathbb { Y } } \mid$ $\mathrm { d o } \big ( \mathbb { v } ^ { \mathbb { z } } \big ) \big )$ is not identifiable in all SCGs depicted in Fig(ure 3∣ and in the SCG in Figure 1a by examining all possible iterations of the rules of the do-calculus. However, it is well known that exhaustively examining all possibilities for applying the rules of do-calculus can quickly become impractical, particularly for large graphs. To address this challenge, the following subsection introduces a sub-graphical structure designed to directly determine whether it is feasible to express an interventional distribution solely in terms of observational distributions using do-calculus and SCGs.

# Strongly Connected Hedges and Non-identifiability

In ADMGs, there exists a sub-graphical structure, called an Hedge (Shpitser and Pearl 2006), which is employed to graphically characterize non-identifiability as shown in Shpitser and Pearl 2006, Theorem 4. To properly define it for SCGs, it is essential to first familiarize oneself with the two related definitions which we have adapted and provided below specifically for the context of SCGs:

Definition 9 (C-component, Tian and Pearl 2002). Let $\mathcal { G } ^ { s } =$ $( \mathbb { S } , \mathbb { E } ^ { s } )$ be an SCG. A subset of vertices $\mathbb { V } \subseteq \mathbb { S }$ suchGtha=t $\Dot { \forall } V , V ^ { \prime } \in \mathbb { V } , \ \exists V ^ { 1 } , \cdots , V ^ { n } \in \mathbb { V }$ with $V ^ { 1 } = V$ $V ^ { n } = V ^ { \prime }$ and $\forall i \in [ 1 , n - 1 ] V ^ { i } {  } {  } {  } V ^ { i + 1 }$ is called a $C$ -compon=ent.

Definition 10 (C-forest, Shpitser and Pearl 2006). Let $\mathcal { G } ^ { s } = \iota$ $( \mathbb { S } , \mathbb { E } ^ { s } )$ be an SCG. A subgraph2 of $\mathcal { G } ^ { s } = ( \mathbb { S } , \mathbb { E } ^ { s } )$ whicGh i=s acyclic, where every vertex has at most one child (i.e., is a forest), and is a $C$ -component is called a C-forest.

![](images/5ebde09e3045016c1487cca99c8e9e1b7f428e1414ed2c566d34e73b1f316f7e.jpg)  
(d) SC-projection of Figure 3c.   
Figure 4: SC-projections of the SCGs in Figures 1 and 3. Each pair of red and blue vertices represents the total effect we are interested in, and the red edges indicate those added through the SC-projection.

Definition 11 (Hedge, Shpitser and Pearl 2006, 2008). Consider an SCG $\mathcal { G } ^ { s } = \left( \mathbb { S } , \mathbb { E } ^ { s } \right)$ and two sets of vertices X, $\mathbb { Y } \subset \mathbb { S }$ . Let F and $\mathbb { F } ^ { \prime } b e R$ -=ro(oted $C$ -forests in $\mathcal { G } ^ { s }$ such that ${ \mathbb X } \cap { \mathbb F } \neq \emptyset$ , ${ \mathbb X } \cap \mathbb { F } ^ { \prime } = \emptyset$ , $\mathbb { F } ^ { \prime } \subseteq \mathbb { F }$ , and $R \subset A n ( Y , \mathcal { G } _ { \mathbb { Z } } ^ { s } )$ . Then $\mathbb { F }$ and $\mathbb { F } ^ { \prime }$ f≠or∅m an Hedge for $\operatorname* { P r } \bigl ( \mathbb { v } ^ { \mathbb { y } } \mid d o ( \mathbb { v } ^ { \mathbb { x } } ) \bigr )$ in $\mathcal G ^ { s }$ .

An Hedge turned out to be too weak to cover nonidentifiability in SCGs. For example, the SCG in Figure 3a contains no Hedge but the macro total effect is not identifiable due to the cycle between $X$ and $Y$ . Consequently, we introduce a new notion designed to graphically characterize non-identifiability of macro total effects in SCGs.

Definition 12 (Strongly connected projection (SC-projection)). Consider an SCG $\mathcal { G } ^ { s } = \{ \mathbb { S } , \mathbb { E } ^ { s } \}$ . The SC-projection $\mathcal { H } ^ { s }$ of $\mathcal { G } ^ { s }$ is the graph thaGt in=c u{des al}l vertices and edges fHrom $\mathcal G ^ { s }$ , plus a bidirected dashed edge between each pair $X , Y \in \mathbb { S }$ such that $S c c ( X , { \mathcal { G } } ^ { s } ) = S c c ( Y , { \mathcal { G } } ^ { s } )$ and $X \neq Y$ .

Definition 13 (Strongly connected Hedge (SC-Hedge)). Consider an SCG $\mathcal { G } ^ { s } = \{ \mathbb { S } , \mathbb { E } ^ { s } \}$ and its $S C$ -projection $\mathcal { H } ^ { s }$ . An Hedge for $\operatorname* { P r } ( \mathbb { v } ^ { \mathbb { y } } \mid d o ( \mathbb { v } ^ { \mathbb { x } } ) )$ }in $\mathcal { H } ^ { s }$ is an SC-HedgeHfor $\operatorname* { P r } \bigl ( \mathbb { v } ^ { \mathbb { y } } \mid d o ( \mathbb { v } ^ { \mathbb { x } } ) \bigr )$ in( $\mathcal G ^ { s }$ .∣

Theorem 5. If there exists a SC-Hedge for $\operatorname* { P r } \bigl ( \mathbb { v } ^ { \mathbb { y } } \mid d o ( \mathbb { v } ^ { \mathbb { x } } ) \bigr )$ in $\mathcal { G } ^ { s }$ then $\operatorname* { P r } \ ( \mathbb { v } ^ { \mathbb { y } } \mid d o ( \mathbb { v } ^ { \mathbb { z } } ) )$ is not identifiable.

Proof. Consider an SCG $\mathcal { G } ^ { s } = ( \mathbb { S } , \mathbb { E } )$ , its SC-projection $\mathcal { H } ^ { s }$ , and a SC-Hedge $\mathbb { F } , \mathbb { F } ^ { \prime }$ foGr $\operatorname* { P r } \bigl ( \mathbb { v } ^ { \mathbb { y } } \ | \ \mathrm { d o } ( \mathbb { v } ^ { \mathbb { z } } ) \bigr )$ . Let us proHve Theorem 5 by induction on the(num∣ber (of b)i)directed dashed edges in the C-forest $\mathbb { F }$ that are in $\mathcal { H } ^ { s }$ but not in $\mathcal { G } ^ { s }$ (i.e., which are artificially induced by cycHles). Firstly, i $\mathbb { F } , \mathbb { F } ^ { \prime }$ is an Hedge in $\mathcal { G } ^ { s }$ then there exists a compatible FT-ADMG in which for anyG $\exists t \in \left[ t _ { 0 } , t _ { m a x } \right]$ , $\mathbb { F } _ { t } = \{ \bar { F _ { t } } | F \in \mathbb { F } \}$ , $\mathbb { F } _ { t } ^ { \prime } = \left\{ F _ { t } \ \right.$ $F \in \mathbb { F } ^ { \prime } \}$ is an ∃He∈dg[e for $\operatorname* { P r } \bigl ( \mathbb { v } ^ { \mathbb { y } } \mid \mathrm { d o } \bigl ( \mathbb { v } ^ { \mathbb { z } } \bigr ) \bigr )$ an∈d t}hus $\operatorname* { P r } ( \mathbb { v } ^ { \mathbb { y } } \mid$ $\mathrm { d o } \big ( \mathbb { v } ^ { \mathbb { x } } \big ) \big )$ is not identifiable. S(eco∣ndly(, if)t)here exists $X \in \mathbb { X }$ and( $Y \in \mathbb { Y }$ such that $S c c ( X , { \mathcal { G } } ^ { s } ) = S c c ( Y , { \mathcal { G } } ^ { s } )$ then there∈exists a  ∈ompatible FT-AD(MG in) =which $\exists t \in [ t _ { 0 } , t _ { m a x } ]$ there is a directed path from $Y _ { t }$ to $X _ { t }$ . This p∃ath∈m[ ust be bl]ocked but every vertex on this path is a descendant of $Y _ { t }$ and thus cannot be adjusted on without inducing a bias. Lastly, assume that Theorem 5 is true for any SC-Hedge with $k$ bidirected dashed edges which are in $\mathcal { H } ^ { s }$ but not in $\mathcal { G } ^ { s }$ and that $\mathbb { F }$ has $k + 1$ such edges. Then, one cannot identify the macro total effect by the adjustment formula (Shpitser, VanderWeele, and Robins 2010) due to the ambiguity (Assaad et al. 2024) induced by the cycle on $X$ or due to the bias induced by the latent confounder of $X$ that cannot be removed without using any rule of the do-calculus. Moreover, any decomposition of the effect using the do-calculus will necessitate the identification of other macro total effects. These effects have sub-C-forests of F, $\mathbb { F } ^ { \prime }$ as SC-Hedges and at least one of theses sub-C-forests has at most $k$ artificial bidirected dashed edges induced by cycles. The associated total macro effect is therefore unidentifiable by induction. □

For example, each SCG depicted in Figures 1 and 3 features an SC-Hedge. This is apparent from their SCprojections shown in Figure 4, where an Hedge is clearly present. This implies, based on Theorem 5, that in these cases, the total effect is not identifiable.

# Related Works

The idea of representing complex low-level causal structures as partially specified high-level graphs has gained some interest in the last years. For instance, Iwasaki and Simon 1994; Chalupka, Eberhardt, and Perona 2016; Anand et al. 2023; Wahl, Ninad, and Runge 2024; Ferreira and Assaad 2024; Assaad et al. 2024 have explored clustering of low-level variables. Notably, Anand et al. 2023 introduced cluster-ADMGs, which generalize acyclic directed mixed graphs by allowing flexible partitioning of variables while maintaining acyclicity. They extended d-separation and the do-calculus to accommodate macro causal effects in these graphs. Even if SCGs, discussed in our paper, are somehow related (in both graphs vertices represent clusters) to clusterADMGs they are inherently different since SCGs can contain cycles. It should be noted that Richardson 1997; Forre´ and Mooij 2017, 2018; Forre´ and Mooij 2020 extended dseparation and do-calculus to DMGs, potentially applicable to macro queries in cluster-DMGs. Although SCGs are a type of cluster-DMG, the applicability of these findings to SCGs remains uncertain due to the specific temporal information within each cluster in an SCGs, which might affect the completeness for macro queries but not necessarily their soundness. Our research suggests that this temporal knowledge does not improve the identifiability of macro queries.

In dynamic systems, Assaad, Ez-Zejjari, and Zan 2023; Ferreira and Assaad 2024; Assaad et al. 2024 considered SCGs but for micro queries. They showed that the total effect and the direct effect is identifiable under some mild conditions if there are no hidden confounding which is different from macro causal effects as they are always identifiable when there is no hidden confounding. As far as we know there exists still no sound and complete result for dseparation and the do-calculus for SCG in the more general case for micro queries, i.e., the results presented in this paper do not apply to micro queries. For example, in the context of conditional independencies, even if $X \bot \bar { g } s Y \mid \mathbb { W }$ in the SCG, we cannot infer that $X _ { t - 1 } \sqcup _ { \mathcal { G } } Y _ { t } \mid \tilde { \mathbb { V } } ^ { \mathbb { W } }$ where $\mathcal { G }$ is compatible with $\mathcal { G } ^ { s }$ and $\tilde { \mathbb { V } } ^ { \mathbb { W } }$ does not−incGlude∣ all variablesGrepresented by $\mathbb { V } ^ { \mathbb { W } }$ . IGn the context of total effects, Assaad et al. 2024 demonstrated that the total effect $\operatorname* { P r } \bigl ( y _ { t } \mid \operatorname { d o } ( x _ { t - 1 } ) \bigr )$ is identifiable even if there is a bidirectional a row $X  Y$ in the SCG, provided there are no other cycles involvin⇄g $X$ and $Y$ as in Figure 3a. However, the do-calculus rules described in this paper cannot identify micro queries. It is not complete in the sense that it does not identify every identifiable queries. In the context of macro queries within dynamic systems, Reiter et al. 2024 explored the identifiability of causal effects from one spectrum (or frequency) to another using SCGs, without delving into the graphical conditions like the ones presented in this paper. Furthermore, in parallel (and independently) to this work, Boeken and Mooij 2024 examined a more general scenario where time is treated as continuous, and instantaneous cycles are possible in the full-time graph.

In a different view, Rubenstein et al. 2017; Beckers and Halpern 2019 studied more general notions of abstraction, namely exact $( \tau - \omega )$ -transformations and $\tau$ -abstractions. If one is only focus−ed in the macro effects then the SCG can be seen as a constructive $\tau$ -abstraction where $\tau$ is the identity in $\mathbb { R } ^ { | [ t _ { 0 } , t _ { m a x } ] | }$ (assuming the micro variables take values in $\mathbb { R }$ ). Which means that all contributions of this paper can contribute to the development of the theory of more general notion of abstraction. However, this is no longer true if one is interested in the micro effects.

# Conclusion

In this paper, we established the soundness and completeness of d-separation and the do-calculus for respectively identifying macro conditional independencies and macro total effects in SCGs. By doing so, we bridged the gap between SCGs and many real-world applications in epidemiology.

There are three main limitations to this work. The first limitation is that the completeness result in Theorem 4 does not take into account that there might exists different iterations of the rules of the do-calculus in different FT-ADMGs that can give the same final identification of the total effect. A second related limitation is that we provided a graphical characterization for the non-identifiability of macro total effects, however this characterization is not necessarily complete, therefore in future works we want to see if a complete characterization might involve SC-Hedges in some way. The third limitation is that our results require a complete observation in time of the entire event system, which is often not feasible in practice. For example, it is challenging to ensure that data collection begins at the onset of each epidemic outbreak. Without this assumption, past instances of observed variables might act as unobserved confounders. In these situations, it would be worthwhile to explore the potential use of instrumental variables (Pearl 2009) to address these challenges. When instrumental variables are unavailable, our results may still be useful for partially identifying macro total effects using SCGs by deriving bounds for the effect under a minimal set of assumptions (Robins 1989; Manski 1990; Pearl 2009; Zhang and Bareinboim 2021).